var BABYLON;!function(e){var n=function(){function n(){}return Object.defineProperty(n,"VersionNumber",{get:function(){return"4.1.0 - A1"},enumerable:!0,configurable:!0}),n.EnableSceneLoader=function(n){e.SceneManager.EnableSceneParsing=n},n.IsSceneLoaderEnabled=function(){return e.SceneManager.EnableSceneParsing},n.IsWindows=function(){return"undefined"!=typeof Windows&&"undefined"!=typeof Windows.UI&&"undefined"!=typeof Windows.System&&"undefined"!=typeof Windows.Foundation},n.IsCordova=function(){return null!=window.cordova},n.IsWebAssembly=function(){return window.WebAssembly},n.IsOculusBrowser=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/OculusBrowser/i)&&(e=!0),e},n.IsSamsungBrowser=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/SamsungBrowser/i)&&(e=!0),e},n.IsWindowsPhone=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Windows Phone/i)&&(e=!0),e},n.IsBlackBerry=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/BlackBerry/i)&&(e=!0),e},n.IsOperaMini=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Opera Mini/i)&&(e=!0),e},n.IsAndroid=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Android/i)&&(e=!0),e},n.IsWebOS=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/webOS/i)&&(e=!0),e},n.IsIOS=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPhone|iPad|iPod/i)&&(e=!0),e},n.IsIPHONE=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPhone/i)&&(e=!0),e},n.IsIPAD=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPad/i)&&(e=!0),e},n.IsIPOD=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPod/i)&&(e=!0),e},n.IsIE11=function(){return void 0!==navigator.msMaxTouchPoints},n.IsMobile=function(){var e=!1;if(null!=navigator&&null!=navigator.userAgent){var n=navigator.userAgent;(n.match(/Android/i)||n.match(/webOS/i)||n.match(/iPhone|iPad|iPod/i)||n.match(/BlackBerry/i)||n.match(/Opera Mini/i)||n.match(/Windows Phone/i))&&(e=!0)}return e},n.IsPlaystation=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Playstation/i)&&(e=!0),e},n.IsXboxOne=function(){var n=!1;if(e.SceneManager.IsWindows()&&"undefined"!=typeof Windows.System.Profile&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo.versionInfo&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily){var t=Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily;t.match(/Xbox/i)&&(n=!0)}return n},n.IsXboxLive=function(){return e.SceneManager.IsWindows()&&"undefined"!=typeof Microsoft&&"undefined"!=typeof Microsoft.Xbox&&"undefined"!=typeof Microsoft.Xbox.Services},n.RunOnce=function(e,n){e.onBeforeRenderObservable.addOnce(n)},n.PopupDebug=function(e){e.debugLayer&&(e.debugLayer.hide(),e.debugLayer.show({enablePopup:!0,globalRoot:null}))},n.ToggleDebug=function(n,t,a){if(void 0===t&&(t=!1),void 0===a&&(a=null),n.debugLayer){var r=window;e.SceneManager.debugLayerVisible===!0?(e.SceneManager.debugLayerVisible=!1,r.METER&&r.METER.show&&r.METER.show(),n.debugLayer.hide()):(e.SceneManager.debugLayerVisible=!0,r.METER&&r.METER.hide&&r.METER.hide(),n.debugLayer.show({enablePopup:t,globalRoot:a}))}},n.DisposeScene=function(n,t){void 0===t&&(t=new e.Color4(0,0,0,1));var a=n.getEngine();n.dispose(),a.clear(t,!0,!0,!0)},n.SetTimeout=function(n,t){var a=null;return a=TimerPlugin.requestTimeout(function(){null!=a&&e.SceneManager.ClearTimeout(a),null!=t&&t()},n)},n.ClearTimeout=function(e){TimerPlugin.clearRequestTimeout(e)},n.SetInterval=function(e,n){return TimerPlugin.requestInterval(n,e)},n.ClearInterval=function(e){TimerPlugin.clearRequestInterval(e)},n.RayCast=function(e,n,t,a){return e.pickWithRay(n,t,a)},n.MultiRayCast=function(e,n,t){return e.multiPickWithRay(n,t)},n.SafeDestroy=function(n,t,a){void 0===t&&(t=5),void 0===a&&(a=!1),t>0?(a===!0&&n.setEnabled(!1),e.SceneManager.SetTimeout(t,function(){n.dispose(!1,!1)})):n.dispose(!1,!1)},n.AlertMessage=function(n,t){void 0===t&&(t="Babylon.js");var a=null;return e.SceneManager.IsWindows()?a=new Windows.UI.Popups.MessageDialog(n,t).showAsync():window.alert(n),a},n.GetQueryStringParam=function(e,n){n||(n=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=t.exec(n);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},n.GetWebGLVersionString=function(e){var n="WebGL - Unknown";if(null!=e){var t=e.getEngine();if(null!=t){var a=t.getGlInfo();null!=a&&(n=a.version+" - "+a.renderer)}}return n},n.GetWebGLVersionNumber=function(e){var n=0;if(null!=e){var t=e.getEngine();null!=t&&(n=t.webGLVersion)}return n},n.GetDeltaSeconds=function(e){return e.getEngine().getDeltaTime()/1e3},n.GetMaterialInstance=function(e,n,t){void 0===t&&(t=null);var a=e.getMaterialByName(n);return null==a&&null!=t&&(a=t(n)),null!=a?a:null},n.SetWindowsLaunchMode=function(n){e.SceneManager.IsWindows()&&"undefined"!=typeof Windows.UI.ViewManagement&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationView&&(Windows.UI.ViewManagement.ApplicationView.preferredLaunchWindowingMode=Windows.UI.ViewManagement.ApplicationViewWindowingMode.fullScreen)},n.RemoveSceneLoader=function(){window.removeSceneLoader?window.removeSceneLoader():e.Tools.Warn("Default remove scene loader function not available.")},n.QuitWindowsApplication=function(){e.SceneManager.IsWindows()&&window.close()},n.GetEngineInstances=function(){return e.EngineStore.Instances},n.GetLastCreatedEngine=function(){return e.EngineStore.LastCreatedEngine},n.GetLastCreatedScene=function(){return e.EngineStore.LastCreatedScene},n.GetMesh=function(e,n){return e.getNodeByName(n)},n.GetTransform=function(e,n){return null==e?null:e.getNodeByName(n)},n.GetPrefabMesh=function(n,t){var a="Prefab."+t;return e.SceneManager.GetMesh(n,a)},n.GetPrimitiveMeshes=function(e){return e.getChildMeshes(!0,function(e){return e.name.indexOf("_primitive")>=0})},n.GetCollisionMeshes=function(e){return e.getChildMeshes(!0,function(e){return e.name.indexOf("_collider")>=0})},n.GetNavigationMesh=function(n){return e.SceneManager.GetMesh(n,"NavigationMesh")},n.InstantiatePrefab=function(n,t,a,r,i,o,s){if(void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),null==n)return null;var l=null,u=e.SceneManager.GetPrefabMesh(n,t);if(null!=u)if(l=u.clone(a,r,!1),null!=l){null!=i&&(l.position=i),null!=o&&(l.rotation=o),null!=s&&(l.scaling=s);var c=null,p=l.getChildren(null,!1);null!=p&&(c=p),null==c?c=[l]:c.unshift(l);var d=new e.MetadataParser(n);c.forEach(function(n){n.name=e.Utilities.ReplaceAll(n.name,"Prefab.",""),n.id=e.Utilities.CreateGuid(n.uniqueId.toFixed()),n.setEnabled(!0);var t=n,a=t.source||t.sourceMesh;if(null!=a&&null==t.skeleton&&null!=a.skeleton){var r=t.name+"."+a.skeleton.name;if(t.skeleton=a.skeleton.clone(r,r),null!=t.skeleton&&null!=t.skeleton.bones&&null!=a.skeleton.bones&&t.skeleton.bones.length===a.skeleton.bones.length)for(var i=t.skeleton.bones.length,o=0;o<i;o++){var s=t.skeleton.bones[o];null==s.metadata&&null!=a.skeleton.bones[o].metadata&&(s.metadata=a.skeleton.bones[o].metadata)}}d.parseSceneComponents(t)}),d.postProcessSceneComponents()}else e.Tools.Warn("Failed to create prefab of: "+t);else e.Tools.Warn("Failed to lookup source mesh: "+t);return l},n.RegisterScriptComponent=function(e,n){void 0===n&&(n=!0),null!=e&&e.registerComponentInstance&&e.registerComponentInstance(e,n)},n.DestroyScriptComponent=function(e){null!=e&&e.destroyComponentInstance&&e.destroyComponentInstance(e)},n.FindScriptComponent=function(e,n){if(null==e)return null;var t=null;if(null!=e.metadata&&e.metadata.unity){var a=e.metadata.unity;if(null!=a.components&&a.components.length>0)for(var r=0;r<a.components.length;r++){var i=a.components[r];if(null!=i.instance&&i.klass===n){t=i.instance;break}}}return null!=t?t:null},n.FindScriptComponents=function(e,n){if(null==e)return null;var t=null;if(null!=e.metadata&&e.metadata.unity){var a=e.metadata.unity;if(null!=a.components&&a.components.length>0)for(var r=0;r<a.components.length;r++){var i=a.components[r];null!=i.instance&&i.klass===n&&t.push(i.instance)}}return null!=t?t:null},n.FindSceneMetadata=function(e){return null==e?null:null!=e.metadata&&e.metadata.unity?e.metadata.unity:null},n.FindSceneParticleRig=function(e){return null==e?null:null!=e.particleRig?e.particleRig:null},n.FindSceneCameraRig=function(e){return null==e?null:null!=e.cameraRig?e.cameraRig:null},n.FindSceneLightRig=function(e){return null==e?null:null!=e.lightRig?e.lightRig:null},n.FindSceneFlareRig=function(e){return null==e?null:null!=e.flareRig?e.flareRig:null},n.FindSceneChildMesh=function(n,t,a,r,i){if(void 0===a&&(a=e.SearchType.StartsWith),void 0===r&&(r=!0),void 0===i&&(i=null),null==n)return null;var o=null!=a?a:e.SearchType.StartsWith,s=n.getChildMeshes(r,i);return e.Utilities.FindMesh(t,s,o)},n.FindSceneChildTransform=function(n,t,a,r,i){if(void 0===a&&(a=e.SearchType.StartsWith),void 0===r&&(r=!0),void 0===i&&(i=null),null==n)return null;var o=null!=a?a:e.SearchType.StartsWith,s=n.getChildTransformNodes(r,i);return e.Utilities.FindMesh(t,s,o)},n.GetNavigationZone=function(){return"scene"},n.BuildNavigationNodes=function(n,t){void 0===t&&(t=null);var a=null,r=t||e.SceneManager.GetNavigationMesh(n);if(null!=r){a=new Navigation;var i=a.buildNodes(r);null!=i?a.setZoneData(e.SceneManager.GetNavigationZone(),i):e.Tools.Warn("Failed to build navigation zone nodes")}else e.Tools.Warn("Failed to locate scene navigation mesh");return a},n.FindNavigationPath=function(n,t,a){var r=e.SceneManager.GetNavigationZone(),i=n.getGroup(r,t);return n.findPath(t,a,r,i)},n.ApplyEntityForce=function(e,n,t){null!=e&&null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&null!=n&&e.physicsImpostor.applyForce(n,t)},n.ApplyEntityImpulse=function(e,n,t){null!=e&&null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&null!=n&&e.physicsImpostor.applyImpulse(n,t)},n.ApplyEntityFriction=function(e,n){null!=e&&null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&null!=e.physicsImpostor.physicsBody.material&&e.physicsImpostor.physicsBody.material.friction!==n&&(e.physicsImpostor.physicsBody.material.friction=n)},n.GetEntityMass=function(e){if(null==e)return 0;var n=0;return null!=e.physicsImpostor&&(n=e.physicsImpostor.mass),n},n.SetEntityMass=function(e,n){null!=e&&null!=e.physicsImpostor&&(e.physicsImpostor.mass=n)},n.GetEntityRestitution=function(e){if(null==e)return 0;var n=0;return null!=e.physicsImpostor&&(n=e.physicsImpostor.restitution),n},n.SetEntityRestitution=function(e,n){null!=e&&null!=e.physicsImpostor&&(e.physicsImpostor.restitution=n)},n.GetEntityFrictionLevel=function(e){if(null==e)return 0;var n=0;return null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&null!=e.physicsImpostor.physicsBody.material&&(n=e.physicsImpostor.physicsBody.material.friction),n},n.GetEntityLinearVelocity=function(e){if(null==e)return null;var n=null;return null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&(n=e.physicsImpostor.getLinearVelocity()),n},n.SetEntityLinearVelocity=function(e,n){null!=e&&null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&null!=n&&e.physicsImpostor.setLinearVelocity(n)},n.GetEntityAngularVelocity=function(e){if(null==e)return null;var n=null;return null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&(n=e.physicsImpostor.getAngularVelocity()),n},n.SetEntityAngularVelocity=function(e,n){null!=e&&null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&null!=n&&e.physicsImpostor.setAngularVelocity(n)},n.CheckEntityCollisionContact=function(e,n,t,a){if(void 0===a&&(a=.5),null==e)return!1;var r=!1;return null!=e.physicsImpostor&&null!=e.physicsImpostor.physicsBody&&(r=!0),r},n.ShowEntityPhysicsImpostor=function(n,t){null!=t&&null!=t.physicsImpostor&&null!=t.physicsImpostor.physicsBody&&(null==e.SceneManager.PhysicsViewer&&(e.SceneManager.PhysicsViewer=new e.Debug.PhysicsViewer(n)),null!=e.SceneManager.PhysicsViewer&&e.SceneManager.PhysicsViewer.showImpostor(t.physicsImpostor))},n.HideEntityPhysicsImpostor=function(n,t){null!=t&&null!=t.physicsImpostor&&null!=t.physicsImpostor.physicsBody&&null!=e.SceneManager.PhysicsViewer&&e.SceneManager.PhysicsViewer.hideImpostor(t.physicsImpostor)},n.MoveWithCollisions=function(e,n){return null==e?null:void(null!=n&&e.moveWithCollisions(n))},n.MoveWithTranslation=function(e,n){return null==e?null:void(null!=n&&e.position.addInPlace(n))},n.TurnWithRotation=function(n,t){return void 0===t&&(t=0),null==n?null:void(0!=t&&n.rotate(e.Axis.Y,t*e.System.Deg2Rad))},n.EnableUserInput=function(n,t){void 0===t&&(t=null);var a=!(null==t||!t.preventDefault)&&t.preventDefault,r=!(null==t||!t.useCapture)&&t.useCapture,i=!(null==t||!t.enableVirtualJoystick)&&t.enableVirtualJoystick,o=!(null==t||!t.disableRightStick)&&t.disableRightStick;e.SceneManager.resetUserInput(),e.SceneManager.input||(document.documentElement.tabIndex=1,document.documentElement.addEventListener("keyup",e.SceneManager.inputKeyUpHandler,r),document.documentElement.addEventListener("keydown",e.SceneManager.inputKeyDownHandler,r),document.documentElement.addEventListener("pointerup",e.SceneManager.inputPointerUpHandler,r),document.documentElement.addEventListener("pointerdown",e.SceneManager.inputPointerDownHandler,r),document.documentElement.addEventListener("pointermove",e.SceneManager.inputPointerMoveHandler,r),document.documentElement.addEventListener("onwheel"in document?"wheel":"mousewheel",e.SceneManager.inputPointerWheelHandler,r),e.SceneManager.preventDefault=a,null==e.SceneManager.GamepadManager&&(e.SceneManager.GamepadManager=new e.GamepadManager,e.SceneManager.GamepadManager.onGamepadConnectedObservable.add(e.SceneManager.inputManagerGamepadConnected),e.SceneManager.GamepadManager.onGamepadDisconnectedObservable.add(e.SceneManager.inputManagerGamepadDisconnected)),e.SceneManager.virtualJoystick===!1&&(e.SceneManager.virtualJoystick=i,e.SceneManager.virtualJoystick===!0&&(null==e.SceneManager.leftJoystick&&(e.SceneManager.leftJoystick=new e.VirtualJoystick((!0)),e.SceneManager.leftJoystick.setJoystickSensibility(5*e.UserInputOptions.JoystickLeftSensibility)),o===!1&&null==e.SceneManager.rightJoystick&&(e.SceneManager.rightJoystick=new e.VirtualJoystick((!1)),e.SceneManager.rightJoystick.reverseUpDown=!0,e.SceneManager.rightJoystick.setJoystickSensibility(5*e.UserInputOptions.JoystickRightSensibility),e.SceneManager.rightJoystick.setJoystickColor(e.UserInputOptions.JoystickRightHandleColor)))),e.SceneManager.input=!0,document.documentElement.focus()),n.registerAfterRender(e.SceneManager.updateUserInput)},n.DisableUserInput=function(n,t){void 0===t&&(t=!1),n.unregisterAfterRender(e.SceneManager.updateUserInput),e.SceneManager.resetUserInput()},n.GetUserInput=function(n,t){void 0===t&&(t=e.PlayerNumber.One);var a=0;if(e.SceneManager.input)switch(n){case e.UserInputAxis.Vertical:case e.UserInputAxis.Horizontal:a=t===e.PlayerNumber.Four?n===e.UserInputAxis.Horizontal?e.SceneManager.horizontal4:e.SceneManager.vertical4:t===e.PlayerNumber.Three?n===e.UserInputAxis.Horizontal?e.SceneManager.horizontal3:e.SceneManager.vertical3:t===e.PlayerNumber.Two?n===e.UserInputAxis.Horizontal?e.SceneManager.horizontal2:e.SceneManager.vertical2:n===e.UserInputAxis.Horizontal?e.SceneManager.horizontal:e.SceneManager.vertical;break;case e.UserInputAxis.MouseX:case e.UserInputAxis.MouseY:a=t===e.PlayerNumber.Four?n===e.UserInputAxis.MouseX?e.SceneManager.mousex4:e.SceneManager.mousey4:t===e.PlayerNumber.Three?n===e.UserInputAxis.MouseX?e.SceneManager.mousex3:e.SceneManager.mousey3:t===e.PlayerNumber.Two?n===e.UserInputAxis.MouseX?e.SceneManager.mousex2:e.SceneManager.mousey2:n===e.UserInputAxis.MouseX?e.SceneManager.mousex:e.SceneManager.mousey;break;case e.UserInputAxis.ClientX:case e.UserInputAxis.ClientY:t===e.PlayerNumber.One&&(a=n===e.UserInputAxis.ClientX?e.SceneManager.clientx:e.SceneManager.clienty);break;case e.UserInputAxis.Wheel:t===e.PlayerNumber.One&&(a=e.SceneManager.wheel)}return a},n.OnKeyboardUp=function(n){e.SceneManager.input&&e.SceneManager.keyButtonUp.push(n)},n.OnKeyboardDown=function(n){e.SceneManager.input&&e.SceneManager.keyButtonDown.push(n)},n.OnKeyboardPress=function(n,t){e.SceneManager.input&&e.SceneManager.keyButtonPress.push({index:n,action:t})},n.GetKeyboardInput=function(n){var t=!1;if(e.SceneManager.input){var a="k:"+n.toString();null!=e.SceneManager.keymap[a]&&(t=e.SceneManager.keymap[a])}return t},n.OnPointerUp=function(n){e.SceneManager.input&&e.SceneManager.mouseButtonUp.push(n)},n.OnPointerDown=function(n){e.SceneManager.input&&e.SceneManager.mouseButtonDown.push(n)},n.OnPointerPress=function(n,t){e.SceneManager.input&&e.SceneManager.mouseButtonPress.push({index:n,action:t})},n.GetPointerInput=function(n){var t=!1;if(e.SceneManager.input){var a="p:"+n.toString();null!=e.SceneManager.keymap[a]&&(t=e.SceneManager.keymap[a])}return t},n.GetLeftJoystick=function(){return e.SceneManager.input?e.SceneManager.leftJoystick:null},n.GetRightJoystick=function(){return e.SceneManager.input?e.SceneManager.rightJoystick:null},n.GetJoystickPress=function(n){var t=!1;return e.SceneManager.input&&(n===e.JoystickButton.Left&&null!=e.SceneManager.leftJoystick&&e.SceneManager.leftJoystick.pressed===!0?t=!0:n===e.JoystickButton.Right&&null!=e.SceneManager.rightJoystick&&e.SceneManager.rightJoystick.pressed===!0&&(t=!0)),t},n.DisposeVirtualJoysticks=function(){e.SceneManager.input&&(null!=e.SceneManager.leftJoystick&&(e.SceneManager.leftJoystick.releaseCanvas(),e.SceneManager.leftJoystick=null),null!=e.SceneManager.rightJoystick&&(e.SceneManager.rightJoystick.releaseCanvas(),e.SceneManager.rightJoystick=null),e.SceneManager.virtualJoystick=!1)},n.OnGamepadButtonUp=function(n,t){if(void 0===t&&(t=e.PlayerNumber.One),e.SceneManager.input)switch(t){case e.PlayerNumber.One:e.SceneManager.gamepad1ButtonUp.push(n);break;case e.PlayerNumber.Two:e.SceneManager.gamepad2ButtonUp.push(n);break;case e.PlayerNumber.Three:e.SceneManager.gamepad3ButtonUp.push(n);break;case e.PlayerNumber.Four:e.SceneManager.gamepad4ButtonUp.push(n)}},n.OnGamepadButtonDown=function(n,t){if(void 0===t&&(t=e.PlayerNumber.One),e.SceneManager.input)switch(t){case e.PlayerNumber.One:e.SceneManager.gamepad1ButtonDown.push(n);break;case e.PlayerNumber.Two:e.SceneManager.gamepad2ButtonDown.push(n);break;case e.PlayerNumber.Three:e.SceneManager.gamepad3ButtonDown.push(n);break;case e.PlayerNumber.Four:e.SceneManager.gamepad4ButtonDown.push(n)}},n.OnGamepadButtonPress=function(n,t,a){if(void 0===a&&(a=e.PlayerNumber.One),e.SceneManager.input)switch(a){case e.PlayerNumber.One:e.SceneManager.gamepad1ButtonPress.push({index:n,action:t});break;case e.PlayerNumber.Two:e.SceneManager.gamepad2ButtonPress.push({index:n,action:t});break;case e.PlayerNumber.Three:e.SceneManager.gamepad3ButtonPress.push({index:n,action:t});break;case e.PlayerNumber.Four:e.SceneManager.gamepad4ButtonPress.push({index:n,action:t})}},n.GetGamepadButtonInput=function(n,t){void 0===t&&(t=e.PlayerNumber.One);var a=!1;if(e.SceneManager.input){var r=null;switch(t){case e.PlayerNumber.One:r="b1:"+n.toString();break;case e.PlayerNumber.Two:r="b2:"+n.toString();break;case e.PlayerNumber.Three:r="b3:"+n.toString();break;case e.PlayerNumber.Four:r="b4:"+n.toString()}null!=r&&null!=e.SceneManager.keymap[r]&&(a=e.SceneManager.keymap[r])}return a},n.OnGamepadDirectionUp=function(n,t){if(void 0===t&&(t=e.PlayerNumber.One),e.SceneManager.input)switch(t){case e.PlayerNumber.One:e.SceneManager.gamepad1DpadUp.push(n);break;case e.PlayerNumber.Two:e.SceneManager.gamepad2DpadUp.push(n);break;case e.PlayerNumber.Three:e.SceneManager.gamepad3DpadUp.push(n);break;case e.PlayerNumber.Four:e.SceneManager.gamepad4DpadUp.push(n)}},n.OnGamepadDirectionDown=function(n,t){if(void 0===t&&(t=e.PlayerNumber.One),e.SceneManager.input)switch(t){case e.PlayerNumber.One:e.SceneManager.gamepad1DpadDown.push(n);break;case e.PlayerNumber.Two:e.SceneManager.gamepad2DpadDown.push(n);break;case e.PlayerNumber.Three:e.SceneManager.gamepad3DpadDown.push(n);break;case e.PlayerNumber.Four:e.SceneManager.gamepad4DpadDown.push(n)}},n.OnGamepadDirectionPress=function(n,t,a){if(void 0===a&&(a=e.PlayerNumber.One),e.SceneManager.input)switch(a){case e.PlayerNumber.One:e.SceneManager.gamepad1DpadPress.push({index:n,action:t});break;case e.PlayerNumber.Two:e.SceneManager.gamepad2DpadPress.push({index:n,action:t});break;case e.PlayerNumber.Three:e.SceneManager.gamepad3DpadPress.push({index:n,action:t});break;case e.PlayerNumber.Four:e.SceneManager.gamepad4DpadPress.push({index:n,action:t})}},n.GetGamepadDirectionInput=function(n,t){void 0===t&&(t=e.PlayerNumber.One);var a=!1;if(e.SceneManager.input){var r=null;switch(t){case e.PlayerNumber.One:r="d1:"+n.toString();break;case e.PlayerNumber.Two:r="d2:"+n.toString();break;case e.PlayerNumber.Three:r="d3:"+n.toString();break;case e.PlayerNumber.Four:r="d4:"+n.toString()}null!=r&&null!=e.SceneManager.keymap[r]&&(a=e.SceneManager.keymap[r])}return a},n.OnGamepadTriggerLeft=function(n,t){if(void 0===t&&(t=e.PlayerNumber.One),e.SceneManager.input)switch(t){case e.PlayerNumber.One:e.SceneManager.gamepad1LeftTrigger.push(n);break;case e.PlayerNumber.Two:e.SceneManager.gamepad2LeftTrigger.push(n);break;case e.PlayerNumber.Three:e.SceneManager.gamepad3LeftTrigger.push(n);break;case e.PlayerNumber.Four:e.SceneManager.gamepad4LeftTrigger.push(n)}},n.OnGamepadTriggerRight=function(n,t){if(void 0===t&&(t=e.PlayerNumber.One),e.SceneManager.input)switch(t){case e.PlayerNumber.One:e.SceneManager.gamepad1RightTrigger.push(n);break;case e.PlayerNumber.Two:e.SceneManager.gamepad2RightTrigger.push(n);break;case e.PlayerNumber.Three:e.SceneManager.gamepad3RightTrigger.push(n);break;case e.PlayerNumber.Four:e.SceneManager.gamepad4RightTrigger.push(n)}},n.GetGamepadTriggerInput=function(n,t){void 0===t&&(t=e.PlayerNumber.One);var a=0;if(e.SceneManager.input){var r=null;switch(t){case e.PlayerNumber.One:r="t1:"+n.toString();break;case e.PlayerNumber.Two:r="t2:"+n.toString();break;case e.PlayerNumber.Three:r="t3:"+n.toString();break;case e.PlayerNumber.Four:r="t4:"+n.toString()}null!=r&&null!=e.SceneManager.keymap[r]&&(a=e.SceneManager.keymap[r])}return a},n.GetGamepadType=function(n){void 0===n&&(n=e.PlayerNumber.One);var t=e.GamepadType.None;if(e.SceneManager.input)switch(n){case e.PlayerNumber.One:t=e.SceneManager.gamepad1Type;break;case e.PlayerNumber.Two:t=e.SceneManager.gamepad2Type;break;case e.PlayerNumber.Three:t=e.SceneManager.gamepad3Type;break;case e.PlayerNumber.Four:t=e.SceneManager.gamepad4Type}return t},n.GetGamepad=function(n){void 0===n&&(n=e.PlayerNumber.One);var t=null;if(e.SceneManager.input)switch(n){case e.PlayerNumber.One:t=e.SceneManager.gamepad1;break;case e.PlayerNumber.Two:t=e.SceneManager.gamepad2;break;case e.PlayerNumber.Three:t=e.SceneManager.gamepad3;break;case e.PlayerNumber.Four:t=e.SceneManager.gamepad4}return t},n.IsXboxLivePluginEnabled=function(){return!!window.isXboxLivePluginEnabled&&window.isXboxLivePluginEnabled()},n.IsXboxLiveUserSignedIn=function(n,t){if(void 0===n&&(n=null),void 0===t&&(t=e.PlayerNumber.One),e.SceneManager.IsXboxLivePluginEnabled()){var a=null!=n?e.SceneManager.GetXboxLiveSystemUser(n,t):e.SceneManager.GetXboxLiveUser(t);return null!=a&&1==a.isSignedIn}return!1},n.XboxLiveUserSignIn=function(n,t,a,r){void 0===n&&(n=e.PlayerNumber.One),e.SceneManager.IsXboxLivePluginEnabled()&&e.SceneManager.XboxLiveUserSilentSignIn(n,function(i){i.status===Microsoft.Xbox.Services.System.SignInStatus.userInteractionRequired?e.SceneManager.XboxLiveUserDialogSignIn(n,function(e){t&&t(e)},a,r):t&&t(i)},a,r)},n.XboxLiveUserSilentSignIn=function(n,t,a,r){return void 0===n&&(n=e.PlayerNumber.One),e.SceneManager.IsXboxLivePluginEnabled()?e.SceneManager.GetXboxLiveUser(n).signInSilentlyAsync(null).then(t,a,r):null},n.XboxLiveUserDialogSignIn=function(n,t,a,r){return void 0===n&&(n=e.PlayerNumber.One),e.SceneManager.IsXboxLivePluginEnabled()?e.SceneManager.GetXboxLiveUser(n).signInAsync(null).then(t,a,r):null},n.LoadXboxLiveUserProfile=function(n,t,a,r){return void 0===n&&(n=e.PlayerNumber.One),e.SceneManager.IsXboxLivePluginEnabled()?e.SceneManager.GetXboxLiveUserContext(n).profileService.getUserProfileAsync(e.SceneManager.GetXboxLiveUser(n).xboxUserId).then(t,a,r):null},n.GetXboxLiveUser=function(n){void 0===n&&(n=e.PlayerNumber.One);var t=null;if(e.SceneManager.IsXboxLivePluginEnabled())switch(n){case e.PlayerNumber.One:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserOne();break;case e.PlayerNumber.Two:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserTwo();break;case e.PlayerNumber.Three:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserThree();break;case e.PlayerNumber.Four:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserFour()}return t},n.GetXboxLiveSystemUser=function(n,t){void 0===t&&(t=e.PlayerNumber.One);var a=null;if(e.SceneManager.IsXboxLivePluginEnabled())switch(t){case e.PlayerNumber.One:a=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserOne(n);break;case e.PlayerNumber.Two:a=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserTwo(n);break;case e.PlayerNumber.Three:a=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserThree(n);break;case e.PlayerNumber.Four:a=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserFour(n)}return a},n.GetXboxLiveUserContext=function(n){void 0===n&&(n=e.PlayerNumber.One);var t=null;if(e.SceneManager.IsXboxLivePluginEnabled())switch(n){case e.PlayerNumber.One:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextOne();break;case e.PlayerNumber.Two:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextTwo();break;case e.PlayerNumber.Three:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextThree();break;case e.PlayerNumber.Four:t=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextFour()}return t},n.ResetXboxLiveUserContext=function(n){if(void 0===n&&(n=e.PlayerNumber.One),e.SceneManager.IsXboxLivePluginEnabled()&&e.SceneManager.IsXboxLivePluginEnabled())switch(n){case e.PlayerNumber.One:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextOne();break;case e.PlayerNumber.Two:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextTwo();break;case e.PlayerNumber.Three:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextThree();break;case e.PlayerNumber.Four:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextFour()}},n.GetXboxLiveContextProperty=function(n){return e.SceneManager.IsXboxLivePluginEnabled()?window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextProperty(n):null},n.SetXboxLiveContextProperty=function(n,t){e.SceneManager.IsXboxLivePluginEnabled()&&window.BabylonToolkit.XboxLive.Plugin.setXboxLiveContextProperty(n,t)},n.ResetXboxLivePropertyContexts=function(){e.SceneManager.IsXboxLivePluginEnabled()&&window.BabylonToolkit.XboxLive.Plugin.resetXboxLivePropertyContexts()},n.SetXboxLiveSignOutHandler=function(n){void 0===n&&(n=null),e.SceneManager.IsXboxLivePluginEnabled()&&(window.BabylonToolkit.XboxLive.Plugin.onusersignout=n)},n.updateUserInput=function(){e.SceneManager.inputVirtualJoysticks(),e.SceneManager.x_horizontal=0,e.SceneManager.x_vertical=0,e.SceneManager.x_mousex=0,e.SceneManager.x_mousey=0,0!==e.SceneManager.j_horizontal?e.SceneManager.x_horizontal=e.SceneManager.j_horizontal:0!==e.SceneManager.k_horizontal?e.SceneManager.x_horizontal=e.SceneManager.k_horizontal:0!==e.SceneManager.g_horizontal1&&(e.SceneManager.x_horizontal=e.SceneManager.g_horizontal1),0!==e.SceneManager.j_vertical?e.SceneManager.x_vertical=e.SceneManager.j_vertical:0!==e.SceneManager.k_vertical?e.SceneManager.x_vertical=e.SceneManager.k_vertical:0!==e.SceneManager.g_vertical1&&(e.SceneManager.x_vertical=e.SceneManager.g_vertical1),0!==e.SceneManager.j_mousex?e.SceneManager.x_mousex=e.SceneManager.j_mousex:0!==e.SceneManager.k_mousex?e.SceneManager.x_mousex=e.SceneManager.k_mousex:0!==e.SceneManager.g_mousex1&&(e.SceneManager.x_mousex=e.SceneManager.g_mousex1),0!==e.SceneManager.j_mousey?e.SceneManager.x_mousey=e.SceneManager.j_mousey:0!==e.SceneManager.k_mousey?e.SceneManager.x_mousey=e.SceneManager.k_mousey:0!==e.SceneManager.g_mousey1&&(e.SceneManager.x_mousey=e.SceneManager.g_mousey1),e.SceneManager.horizontal=e.SceneManager.x_horizontal,e.SceneManager.vertical=e.SceneManager.x_vertical,e.SceneManager.mousex=e.SceneManager.x_mousex,e.SceneManager.mousey=e.SceneManager.x_mousey,e.SceneManager.wheel=e.SceneManager.x_wheel,e.SceneManager.horizontal2=e.SceneManager.g_horizontal2,e.SceneManager.vertical2=e.SceneManager.g_vertical2,e.SceneManager.mousex2=e.SceneManager.g_mousex2,e.SceneManager.mousey2=e.SceneManager.g_mousey2,e.SceneManager.horizontal3=e.SceneManager.g_horizontal3,e.SceneManager.vertical3=e.SceneManager.g_vertical3,e.SceneManager.mousex3=e.SceneManager.g_mousex3,e.SceneManager.mousey3=e.SceneManager.g_mousey3,e.SceneManager.horizontal4=e.SceneManager.g_horizontal4,e.SceneManager.vertical4=e.SceneManager.g_vertical4,e.SceneManager.mousex4=e.SceneManager.g_mousex4,e.SceneManager.mousey4=e.SceneManager.g_mousey4,e.SceneManager.x_mousey=0},n.resetUserInput=function(){e.SceneManager.keymap={},e.SceneManager.wheel=0,e.SceneManager.clientx=0,e.SceneManager.clienty=0,e.SceneManager.mousex=0,e.SceneManager.mousey=0,e.SceneManager.vertical=0,e.SceneManager.horizontal=0,e.SceneManager.mousex2=0,e.SceneManager.mousey2=0,e.SceneManager.vertical2=0,e.SceneManager.horizontal2=0,e.SceneManager.mousex3=0,e.SceneManager.mousey3=0,e.SceneManager.vertical3=0,e.SceneManager.horizontal3=0,e.SceneManager.mousex4=0,e.SceneManager.mousey4=0,e.SceneManager.vertical4=0,e.SceneManager.horizontal4=0,e.SceneManager.x_wheel=0,e.SceneManager.x_mousex=0,e.SceneManager.x_mousey=0,e.SceneManager.x_vertical=0,e.SceneManager.x_horizontal=0,e.SceneManager.k_mousex=0,e.SceneManager.k_mousey=0,e.SceneManager.k_vertical=0,e.SceneManager.k_horizontal=0,e.SceneManager.j_mousex=0,e.SceneManager.j_mousey=0,e.SceneManager.j_vertical=0,e.SceneManager.j_horizontal=0,e.SceneManager.g_mousex1=0,e.SceneManager.g_mousey1=0,e.SceneManager.g_vertical1=0,e.SceneManager.g_horizontal1=0,e.SceneManager.g_mousex2=0,e.SceneManager.g_mousey2=0,e.SceneManager.g_vertical2=0,e.SceneManager.g_horizontal2=0,e.SceneManager.g_mousex3=0,e.SceneManager.g_mousey3=0,e.SceneManager.g_vertical3=0,e.SceneManager.g_horizontal3=0,e.SceneManager.g_mousex4=0,e.SceneManager.g_mousey4=0,e.SceneManager.g_vertical4=0,e.SceneManager.g_horizontal4=0,e.SceneManager.preventDefault=!1,e.SceneManager.mouseButtonUp=[],e.SceneManager.mouseButtonDown=[],e.SceneManager.mouseButtonPress=[],e.SceneManager.keyButtonUp=[],e.SceneManager.keyButtonDown=[],e.SceneManager.keyButtonPress=[],e.SceneManager.gamepad1ButtonUp=[],e.SceneManager.gamepad1ButtonDown=[],e.SceneManager.gamepad1ButtonPress=[],e.SceneManager.gamepad1DpadUp=[],e.SceneManager.gamepad1DpadDown=[],e.SceneManager.gamepad1DpadPress=[],e.SceneManager.gamepad1LeftTrigger=[],e.SceneManager.gamepad1RightTrigger=[],e.SceneManager.gamepad2ButtonUp=[],e.SceneManager.gamepad2ButtonDown=[],e.SceneManager.gamepad2ButtonPress=[],e.SceneManager.gamepad2DpadUp=[],e.SceneManager.gamepad2DpadDown=[],e.SceneManager.gamepad2DpadPress=[],e.SceneManager.gamepad2LeftTrigger=[],e.SceneManager.gamepad2RightTrigger=[],e.SceneManager.gamepad3ButtonUp=[],e.SceneManager.gamepad3ButtonDown=[],e.SceneManager.gamepad3ButtonPress=[],e.SceneManager.gamepad3DpadUp=[],e.SceneManager.gamepad3DpadDown=[],e.SceneManager.gamepad3DpadPress=[],e.SceneManager.gamepad3LeftTrigger=[],
e.SceneManager.gamepad3RightTrigger=[],e.SceneManager.gamepad4ButtonUp=[],e.SceneManager.gamepad4ButtonDown=[],e.SceneManager.gamepad4ButtonPress=[],e.SceneManager.gamepad4DpadUp=[],e.SceneManager.gamepad4DpadDown=[],e.SceneManager.gamepad4DpadPress=[],e.SceneManager.gamepad4LeftTrigger=[],e.SceneManager.gamepad4RightTrigger=[]},n.inputKeyDownHandler=function(n){var t="k:"+n.keyCode.toString(),a=!1;switch(null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,n.keyCode){case 39:case 68:e.SceneManager.k_horizontal=1;break;case 37:case 65:e.SceneManager.k_horizontal=-1;break;case 38:case 87:e.SceneManager.k_vertical=1;break;case 40:case 83:e.SceneManager.k_vertical=-1}return null!=e.SceneManager.keyButtonDown&&e.SceneManager.keyButtonDown.length>0&&e.SceneManager.keyButtonDown.forEach(function(e){e(n.keyCode)}),a||null!=e.SceneManager.keyButtonPress&&e.SceneManager.keyButtonPress.length>0&&e.SceneManager.keyButtonPress.forEach(function(e){e.index===n.keyCode&&e.action()}),e.SceneManager.preventDefault&&n.preventDefault(),!0},n.inputKeyUpHandler=function(n){var t="k:"+n.keyCode.toString();switch(e.SceneManager.keymap[t]=!1,n.keyCode){case 39:case 37:case 68:case 65:e.SceneManager.k_horizontal=0;break;case 38:case 40:case 87:case 83:e.SceneManager.k_vertical=0}return null!=e.SceneManager.keyButtonUp&&e.SceneManager.keyButtonUp.length>0&&e.SceneManager.keyButtonUp.forEach(function(e){e(n.keyCode)}),e.SceneManager.preventDefault&&n.preventDefault(),!0},n.inputPointerWheelHandler=function(n){var t=n.deltaY?-n.deltaY:n.wheelDelta/40;return e.SceneManager.x_wheel=Math.abs(t)>e.UserInputOptions.PointerWheelDeadZone?0+t:0,e.SceneManager.preventDefault&&n.preventDefault(),!0},n.inputPointerDownHandler=function(n){0===n.button&&(e.SceneManager.previousPosition={x:n.clientX,y:n.clientY});var t="p:"+n.button.toString(),a=!1;return null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.mouseButtonDown&&e.SceneManager.mouseButtonDown.length>0&&e.SceneManager.mouseButtonDown.forEach(function(e){e(n.button)}),a||null!=e.SceneManager.mouseButtonPress&&e.SceneManager.mouseButtonPress.length>0&&e.SceneManager.mouseButtonPress.forEach(function(e){e.index===n.button&&e.action()}),e.SceneManager.preventDefault&&n.preventDefault(),!0},n.inputPointerUpHandler=function(n){0===n.button&&null!=e.SceneManager.previousPosition&&(e.SceneManager.previousPosition=null,e.SceneManager.k_mousex=0,e.SceneManager.k_mousey=0);var t="p:"+n.button.toString();return e.SceneManager.keymap[t]=!1,null!=e.SceneManager.mouseButtonUp&&e.SceneManager.mouseButtonUp.length>0&&e.SceneManager.mouseButtonUp.forEach(function(e){e(n.button)}),e.SceneManager.preventDefault&&n.preventDefault(),!0},n.inputPointerMoveHandler=function(n){if(e.SceneManager.virtualJoystick===!1&&null!=e.SceneManager.previousPosition){e.SceneManager.clientx=n.clientX,e.SceneManager.clienty=n.clientY;var t=n.clientX-e.SceneManager.previousPosition.x,a=n.clientY-e.SceneManager.previousPosition.y;e.SceneManager.previousPosition={x:n.clientX,y:n.clientY};var r=t*(e.UserInputOptions.PointerAngularSensibility/10),i=a*(e.UserInputOptions.PointerAngularSensibility/10);0!=r&&(e.SceneManager.k_mousex=r),0!=i&&(e.SceneManager.rightHanded?e.SceneManager.k_mousey=-i:e.SceneManager.k_mousey=i)}return e.SceneManager.preventDefault&&n.preventDefault(),!0},n.inputVirtualJoysticks=function(){if(null!=e.SceneManager.leftJoystick){var n=e.SceneManager.leftJoystick.deltaPosition;e.SceneManager.leftJoystick.pressed||(n=n.scale(.9));var t=n.x,a=n.y;n.x=Math.abs(t)>e.UserInputOptions.JoystickDeadStickValue?0+t:0,n.y=Math.abs(a)>e.UserInputOptions.JoystickDeadStickValue?0+a:0,e.SceneManager.j_horizontal=n.x,e.SceneManager.j_vertical=n.y}if(null!=e.SceneManager.rightJoystick){var r=e.SceneManager.rightJoystick.deltaPosition;e.SceneManager.rightJoystick.pressed||(r=r.scale(.9));var i=r.x,o=r.y;r.x=Math.abs(i)>e.UserInputOptions.JoystickDeadStickValue?0+i:0,r.y=Math.abs(o)>e.UserInputOptions.JoystickDeadStickValue?0+o:0,e.SceneManager.j_mousex=r.x,e.SceneManager.j_mousey=r.y}},n.inputOneButtonDownHandler=function(n){if(null!=e.SceneManager.gamepad1){var t="b1:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad1ButtonDown&&e.SceneManager.gamepad1ButtonDown.length>0&&e.SceneManager.gamepad1ButtonDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad1ButtonPress&&e.SceneManager.gamepad1ButtonPress.length>0&&e.SceneManager.gamepad1ButtonPress.forEach(function(e){e.index===n&&e.action()})}},n.inputOneButtonUpHandler=function(n){if(null!=e.SceneManager.gamepad1){var t="b1:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad1ButtonUp&&e.SceneManager.gamepad1ButtonUp.length>0&&e.SceneManager.gamepad1ButtonUp.forEach(function(e){e(n)})}},n.inputOneXboxDPadDownHandler=function(n){if(null!=e.SceneManager.gamepad1){var t="d1:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad1DpadDown&&e.SceneManager.gamepad1DpadDown.length>0&&e.SceneManager.gamepad1DpadDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad1DpadPress&&e.SceneManager.gamepad1DpadPress.length>0&&e.SceneManager.gamepad1DpadPress.forEach(function(e){e.index===n&&e.action()})}},n.inputOneXboxDPadUpHandler=function(n){if(null!=e.SceneManager.gamepad1){var t="d1:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad1DpadUp&&e.SceneManager.gamepad1DpadUp.length>0&&e.SceneManager.gamepad1DpadUp.forEach(function(e){e(n)})}},n.inputOneXboxLeftTriggerHandler=function(n){null!=e.SceneManager.gamepad1&&(e.SceneManager.keymap["t1:0"]=n,null!=e.SceneManager.gamepad1LeftTrigger&&e.SceneManager.gamepad1LeftTrigger.length>0&&e.SceneManager.gamepad1LeftTrigger.forEach(function(e){e(n)}))},n.inputOneXboxRightTriggerHandler=function(n){null!=e.SceneManager.gamepad1&&(e.SceneManager.keymap["t1:1"]=n,null!=e.SceneManager.gamepad1RightTrigger&&e.SceneManager.gamepad1RightTrigger.length>0&&e.SceneManager.gamepad1RightTrigger.forEach(function(e){e(n)}))},n.inputOneLeftStickHandler=function(n){if(null!=e.SceneManager.gamepad1){var t=n,a=t.x*e.UserInputOptions.GamepadLStickSensibility,r=t.y*e.UserInputOptions.GamepadLStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_horizontal1=e.UserInputOptions.GamepadLStickXInverted?-t.x:t.x,e.SceneManager.g_vertical1=e.UserInputOptions.GamepadLStickYInverted?t.y:-t.y}},n.inputOneRightStickHandler=function(n){if(null!=e.SceneManager.gamepad1){var t=n,a=t.x*e.UserInputOptions.GamepadRStickSensibility,r=t.y*e.UserInputOptions.GamepadRStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_mousex1=e.UserInputOptions.GamepadRStickXInverted?-t.x:t.x,e.SceneManager.g_mousey1=e.UserInputOptions.GamepadRStickYInverted?-t.y:t.y}},n.inputTwoButtonDownHandler=function(n){if(null!=e.SceneManager.gamepad2){var t="b2:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad2ButtonDown&&e.SceneManager.gamepad2ButtonDown.length>0&&e.SceneManager.gamepad2ButtonDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad2ButtonPress&&e.SceneManager.gamepad2ButtonPress.length>0&&e.SceneManager.gamepad2ButtonPress.forEach(function(e){e.index===n&&e.action()})}},n.inputTwoButtonUpHandler=function(n){if(null!=e.SceneManager.gamepad2){var t="b2:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad2ButtonUp&&e.SceneManager.gamepad2ButtonUp.length>0&&e.SceneManager.gamepad2ButtonUp.forEach(function(e){e(n)})}},n.inputTwoXboxDPadDownHandler=function(n){if(null!=e.SceneManager.gamepad2){var t="d2:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad2DpadDown&&e.SceneManager.gamepad2DpadDown.length>0&&e.SceneManager.gamepad2DpadDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad2DpadPress&&e.SceneManager.gamepad2DpadPress.length>0&&e.SceneManager.gamepad2DpadPress.forEach(function(e){e.index===n&&e.action()})}},n.inputTwoXboxDPadUpHandler=function(n){if(null!=e.SceneManager.gamepad2){var t="d2:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad2DpadUp&&e.SceneManager.gamepad2DpadUp.length>0&&e.SceneManager.gamepad2DpadUp.forEach(function(e){e(n)})}},n.inputTwoXboxLeftTriggerHandler=function(n){null!=e.SceneManager.gamepad2&&(e.SceneManager.keymap["t2:0"]=n,null!=e.SceneManager.gamepad2LeftTrigger&&e.SceneManager.gamepad2LeftTrigger.length>0&&e.SceneManager.gamepad2LeftTrigger.forEach(function(e){e(n)}))},n.inputTwoXboxRightTriggerHandler=function(n){null!=e.SceneManager.gamepad2&&(e.SceneManager.keymap["t2:1"]=n,null!=e.SceneManager.gamepad2RightTrigger&&e.SceneManager.gamepad2RightTrigger.length>0&&e.SceneManager.gamepad2RightTrigger.forEach(function(e){e(n)}))},n.inputTwoLeftStickHandler=function(n){if(null!=e.SceneManager.gamepad2){var t=n,a=t.x*e.UserInputOptions.GamepadLStickSensibility,r=t.y*e.UserInputOptions.GamepadLStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_horizontal2=e.UserInputOptions.GamepadLStickXInverted?-t.x:t.x,e.SceneManager.g_vertical2=e.UserInputOptions.GamepadLStickYInverted?t.y:-t.y}},n.inputTwoRightStickHandler=function(n){if(null!=e.SceneManager.gamepad2){var t=n,a=t.x*e.UserInputOptions.GamepadRStickSensibility,r=t.y*e.UserInputOptions.GamepadRStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_mousex2=e.UserInputOptions.GamepadRStickXInverted?-t.x:t.x,e.SceneManager.g_mousey2=e.UserInputOptions.GamepadRStickYInverted?-t.y:t.y}},n.inputThreeButtonDownHandler=function(n){if(null!=e.SceneManager.gamepad3){var t="b3:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad3ButtonDown&&e.SceneManager.gamepad3ButtonDown.length>0&&e.SceneManager.gamepad3ButtonDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad3ButtonPress&&e.SceneManager.gamepad3ButtonPress.length>0&&e.SceneManager.gamepad3ButtonPress.forEach(function(e){e.index===n&&e.action()})}},n.inputThreeButtonUpHandler=function(n){if(null!=e.SceneManager.gamepad3){var t="b3:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad3ButtonUp&&e.SceneManager.gamepad3ButtonUp.length>0&&e.SceneManager.gamepad3ButtonUp.forEach(function(e){e(n)})}},n.inputThreeXboxDPadDownHandler=function(n){if(null!=e.SceneManager.gamepad3){var t="d3:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad3DpadDown&&e.SceneManager.gamepad3DpadDown.length>0&&e.SceneManager.gamepad3DpadDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad3DpadPress&&e.SceneManager.gamepad3DpadPress.length>0&&e.SceneManager.gamepad3DpadPress.forEach(function(e){e.index===n&&e.action()})}},n.inputThreeXboxDPadUpHandler=function(n){if(null!=e.SceneManager.gamepad3){var t="d3:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad3DpadUp&&e.SceneManager.gamepad3DpadUp.length>0&&e.SceneManager.gamepad3DpadUp.forEach(function(e){e(n)})}},n.inputThreeXboxLeftTriggerHandler=function(n){null!=e.SceneManager.gamepad3&&(e.SceneManager.keymap["t3:0"]=n,null!=e.SceneManager.gamepad3LeftTrigger&&e.SceneManager.gamepad3LeftTrigger.length>0&&e.SceneManager.gamepad3LeftTrigger.forEach(function(e){e(n)}))},n.inputThreeXboxRightTriggerHandler=function(n){null!=e.SceneManager.gamepad3&&(e.SceneManager.keymap["t3:1"]=n,null!=e.SceneManager.gamepad3RightTrigger&&e.SceneManager.gamepad3RightTrigger.length>0&&e.SceneManager.gamepad3RightTrigger.forEach(function(e){e(n)}))},n.inputThreeLeftStickHandler=function(n){if(null!=e.SceneManager.gamepad3){var t=n,a=t.x*e.UserInputOptions.GamepadLStickSensibility,r=t.y*e.UserInputOptions.GamepadLStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_horizontal3=e.UserInputOptions.GamepadLStickXInverted?-t.x:t.x,e.SceneManager.g_vertical3=e.UserInputOptions.GamepadLStickYInverted?t.y:-t.y}},n.inputThreeRightStickHandler=function(n){if(null!=e.SceneManager.gamepad3){var t=n,a=t.x*e.UserInputOptions.GamepadRStickSensibility,r=t.y*e.UserInputOptions.GamepadRStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_mousex3=e.UserInputOptions.GamepadRStickXInverted?-t.x:t.x,e.SceneManager.g_mousey3=e.UserInputOptions.GamepadRStickYInverted?-t.y:t.y}},n.inputFourButtonDownHandler=function(n){if(null!=e.SceneManager.gamepad4){var t="b4:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad4ButtonDown&&e.SceneManager.gamepad4ButtonDown.length>0&&e.SceneManager.gamepad4ButtonDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad4ButtonPress&&e.SceneManager.gamepad4ButtonPress.length>0&&e.SceneManager.gamepad4ButtonPress.forEach(function(e){e.index===n&&e.action()})}},n.inputFourButtonUpHandler=function(n){if(null!=e.SceneManager.gamepad4){var t="b4:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad4ButtonUp&&e.SceneManager.gamepad4ButtonUp.length>0&&e.SceneManager.gamepad4ButtonUp.forEach(function(e){e(n)})}},n.inputFourXboxDPadDownHandler=function(n){if(null!=e.SceneManager.gamepad4){var t="d4:"+n.toString(),a=!1;null!=e.SceneManager.keymap[t]&&(a=e.SceneManager.keymap[t]),e.SceneManager.keymap[t]=!0,null!=e.SceneManager.gamepad4DpadDown&&e.SceneManager.gamepad4DpadDown.length>0&&e.SceneManager.gamepad4DpadDown.forEach(function(e){e(n)}),a||null!=e.SceneManager.gamepad4DpadPress&&e.SceneManager.gamepad4DpadPress.length>0&&e.SceneManager.gamepad4DpadPress.forEach(function(e){e.index===n&&e.action()})}},n.inputFourXboxDPadUpHandler=function(n){if(null!=e.SceneManager.gamepad4){var t="d4:"+n.toString();e.SceneManager.keymap[t]=!1,null!=e.SceneManager.gamepad4DpadUp&&e.SceneManager.gamepad4DpadUp.length>0&&e.SceneManager.gamepad4DpadUp.forEach(function(e){e(n)})}},n.inputFourXboxLeftTriggerHandler=function(n){null!=e.SceneManager.gamepad4&&(e.SceneManager.keymap["t4:0"]=n,null!=e.SceneManager.gamepad4LeftTrigger&&e.SceneManager.gamepad4LeftTrigger.length>0&&e.SceneManager.gamepad4LeftTrigger.forEach(function(e){e(n)}))},n.inputFourXboxRightTriggerHandler=function(n){null!=e.SceneManager.gamepad4&&(e.SceneManager.keymap["t4:1"]=n,null!=e.SceneManager.gamepad4RightTrigger&&e.SceneManager.gamepad4RightTrigger.length>0&&e.SceneManager.gamepad4RightTrigger.forEach(function(e){e(n)}))},n.inputFourLeftStickHandler=function(n){if(null!=e.SceneManager.gamepad4){var t=n,a=t.x*e.UserInputOptions.GamepadLStickSensibility,r=t.y*e.UserInputOptions.GamepadLStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_horizontal4=e.UserInputOptions.GamepadLStickXInverted?-t.x:t.x,e.SceneManager.g_vertical4=e.UserInputOptions.GamepadLStickYInverted?t.y:-t.y}},n.inputFourRightStickHandler=function(n){if(null!=e.SceneManager.gamepad4){var t=n,a=t.x*e.UserInputOptions.GamepadRStickSensibility,r=t.y*e.UserInputOptions.GamepadRStickSensibility;t.x=Math.abs(a)>e.UserInputOptions.GamepadDeadStickValue?0+a:0,t.y=Math.abs(r)>e.UserInputOptions.GamepadDeadStickValue?0+r:0,e.SceneManager.g_mousex4=e.UserInputOptions.GamepadRStickXInverted?-t.x:t.x,e.SceneManager.g_mousey4=e.UserInputOptions.GamepadRStickYInverted?-t.y:t.y}},n.inputManagerGamepadConnected=function(n,t){if(null==e.SceneManager.gamepad1&&0===n.index)if(e.SceneManager.gamepad1=n,e.Tools.Log("Gamepad One Connected: "+e.SceneManager.gamepad1.id),e.SceneManager.gamepad1.id.search("Xbox 360")!==-1||e.SceneManager.gamepad1.id.search("Xbox One")!==-1||e.SceneManager.gamepad1.id.search("xinput")!==-1){e.SceneManager.gamepad1Type=e.GamepadType.Xbox360;var a=e.SceneManager.gamepad1;a.onbuttonup(e.SceneManager.inputOneButtonUpHandler),a.onbuttondown(e.SceneManager.inputOneButtonDownHandler),a.onleftstickchanged(e.SceneManager.inputOneLeftStickHandler),a.onrightstickchanged(e.SceneManager.inputOneRightStickHandler),a.ondpadup(e.SceneManager.inputOneXboxDPadUpHandler),a.ondpaddown(e.SceneManager.inputOneXboxDPadDownHandler),a.onlefttriggerchanged(e.SceneManager.inputOneXboxLeftTriggerHandler),a.onrighttriggerchanged(e.SceneManager.inputOneXboxRightTriggerHandler)}else{e.SceneManager.gamepad1Type=e.GamepadType.Generic;var r=e.SceneManager.gamepad1;r.onbuttonup(e.SceneManager.inputOneButtonUpHandler),r.onbuttondown(e.SceneManager.inputOneButtonDownHandler),r.onleftstickchanged(e.SceneManager.inputOneLeftStickHandler),r.onrightstickchanged(e.SceneManager.inputOneRightStickHandler)}if(null==e.SceneManager.gamepad2&&1===n.index)if(e.SceneManager.gamepad2=n,e.Tools.Log("Gamepad Two Connected: "+e.SceneManager.gamepad2.id),e.SceneManager.gamepad2.id.search("Xbox 360")!==-1||e.SceneManager.gamepad2.id.search("Xbox One")!==-1||e.SceneManager.gamepad2.id.search("xinput")!==-1){e.SceneManager.gamepad2Type=e.GamepadType.Xbox360;var i=e.SceneManager.gamepad2;i.onbuttonup(e.SceneManager.inputTwoButtonUpHandler),i.onbuttondown(e.SceneManager.inputTwoButtonDownHandler),i.onleftstickchanged(e.SceneManager.inputTwoLeftStickHandler),i.onrightstickchanged(e.SceneManager.inputTwoRightStickHandler),i.ondpadup(e.SceneManager.inputTwoXboxDPadUpHandler),i.ondpaddown(e.SceneManager.inputTwoXboxDPadDownHandler),i.onlefttriggerchanged(e.SceneManager.inputTwoXboxLeftTriggerHandler),i.onrighttriggerchanged(e.SceneManager.inputTwoXboxRightTriggerHandler)}else{e.SceneManager.gamepad2Type=e.GamepadType.Generic;var o=e.SceneManager.gamepad2;o.onbuttonup(e.SceneManager.inputTwoButtonUpHandler),o.onbuttondown(e.SceneManager.inputTwoButtonDownHandler),o.onleftstickchanged(e.SceneManager.inputTwoLeftStickHandler),o.onrightstickchanged(e.SceneManager.inputTwoRightStickHandler)}if(null==e.SceneManager.gamepad3&&2===n.index)if(e.SceneManager.gamepad3=n,e.Tools.Log("Gamepad Three Connected: "+e.SceneManager.gamepad3.id),e.SceneManager.gamepad3.id.search("Xbox 360")!==-1||e.SceneManager.gamepad3.id.search("Xbox One")!==-1||e.SceneManager.gamepad3.id.search("xinput")!==-1){e.SceneManager.gamepad3Type=e.GamepadType.Xbox360;var s=e.SceneManager.gamepad3;s.onbuttonup(e.SceneManager.inputThreeButtonUpHandler),s.onbuttondown(e.SceneManager.inputThreeButtonDownHandler),s.onleftstickchanged(e.SceneManager.inputThreeLeftStickHandler),s.onrightstickchanged(e.SceneManager.inputThreeRightStickHandler),s.ondpadup(e.SceneManager.inputThreeXboxDPadUpHandler),s.ondpaddown(e.SceneManager.inputThreeXboxDPadDownHandler),s.onlefttriggerchanged(e.SceneManager.inputThreeXboxLeftTriggerHandler),s.onrighttriggerchanged(e.SceneManager.inputThreeXboxRightTriggerHandler)}else{e.SceneManager.gamepad3Type=e.GamepadType.Generic;var l=e.SceneManager.gamepad3;l.onbuttonup(e.SceneManager.inputThreeButtonUpHandler),l.onbuttondown(e.SceneManager.inputThreeButtonDownHandler),l.onleftstickchanged(e.SceneManager.inputThreeLeftStickHandler),l.onrightstickchanged(e.SceneManager.inputThreeRightStickHandler)}if(null==e.SceneManager.gamepad4&&3===n.index)if(e.SceneManager.gamepad4=n,e.Tools.Log("Gamepad Four Connected: "+e.SceneManager.gamepad4.id),e.SceneManager.gamepad4.id.search("Xbox 360")!==-1||e.SceneManager.gamepad4.id.search("Xbox One")!==-1||e.SceneManager.gamepad4.id.search("xinput")!==-1){e.SceneManager.gamepad4Type=e.GamepadType.Xbox360;var u=e.SceneManager.gamepad4;u.onbuttonup(e.SceneManager.inputFourButtonUpHandler),u.onbuttondown(e.SceneManager.inputFourButtonDownHandler),u.onleftstickchanged(e.SceneManager.inputFourLeftStickHandler),u.onrightstickchanged(e.SceneManager.inputFourRightStickHandler),u.ondpadup(e.SceneManager.inputFourXboxDPadUpHandler),u.ondpaddown(e.SceneManager.inputFourXboxDPadDownHandler),u.onlefttriggerchanged(e.SceneManager.inputFourXboxLeftTriggerHandler),u.onrighttriggerchanged(e.SceneManager.inputFourXboxRightTriggerHandler)}else{e.SceneManager.gamepad4Type=e.GamepadType.Generic;var c=e.SceneManager.gamepad4;c.onbuttonup(e.SceneManager.inputFourButtonUpHandler),c.onbuttondown(e.SceneManager.inputFourButtonDownHandler),c.onleftstickchanged(e.SceneManager.inputFourLeftStickHandler),c.onrightstickchanged(e.SceneManager.inputFourRightStickHandler)}null!=e.SceneManager.GamepadConnected&&e.SceneManager.GamepadConnected(n,t)},n.inputManagerGamepadDisconnected=function(n,t){null!=e.SceneManager.GamepadDisconnected&&e.SceneManager.GamepadDisconnected(n,t)},n.inputManagerLeftControllerMainButton=function(e,n){},n.inputManagerLeftControllerPadState=function(e,n){},n.inputManagerLeftControllerPadValues=function(e,n){},n.inputManagerLeftControllerAuxButton=function(e,n){},n.inputManagerLeftControllerTriggered=function(e,n){},n.inputManagerRightControllerMainButton=function(e,n){},n.inputManagerRightControllerPadState=function(e,n){},n.inputManagerRightControllerPadValues=function(e,n){},n.inputManagerRightControllerAuxButton=function(e,n){},n.inputManagerRightControllerTriggered=function(e,n){},n.inputManagerControllerConnected=function(e,n){},n.AnimationStartMode=null,n.ForceRightHanded=null,n.DebugPhysics=!1,n.DataStore={},n.EnableSceneParsing=!0,n.PhysicsViewer=null,n.OnSetupPhysicsPlugin=null,n.GamepadManager=null,n.GamepadConnected=null,n.GamepadDisconnected=null,n.input=!1,n.keymap={},n.wheel=0,n.clientx=0,n.clienty=0,n.mousex=0,n.mousey=0,n.vertical=0,n.horizontal=0,n.mousex2=0,n.mousey2=0,n.vertical2=0,n.horizontal2=0,n.mousex3=0,n.mousey3=0,n.vertical3=0,n.horizontal3=0,n.mousex4=0,n.mousey4=0,n.vertical4=0,n.horizontal4=0,n.x_wheel=0,n.x_mousex=0,n.x_mousey=0,n.x_vertical=0,n.x_horizontal=0,n.k_mousex=0,n.k_mousey=0,n.k_vertical=0,n.k_horizontal=0,n.j_mousex=0,n.j_mousey=0,n.j_vertical=0,n.j_horizontal=0,n.g_mousex1=0,n.g_mousey1=0,n.g_vertical1=0,n.g_horizontal1=0,n.g_mousex2=0,n.g_mousey2=0,n.g_vertical2=0,n.g_horizontal2=0,n.g_mousex3=0,n.g_mousey3=0,n.g_vertical3=0,n.g_horizontal3=0,n.g_mousex4=0,n.g_mousey4=0,n.g_vertical4=0,n.g_horizontal4=0,n.mouseButtonPress=[],n.mouseButtonDown=[],n.mouseButtonUp=[],n.keyButtonPress=[],n.keyButtonDown=[],n.keyButtonUp=[],n.leftJoystick=null,n.rightJoystick=null,n.virtualJoystick=!1,n.previousPosition=null,n.preventDefault=!1,n.rightHanded=!0,n.gamepad1=null,n.gamepad1Type=-1,n.gamepad1ButtonPress=[],n.gamepad1ButtonDown=[],n.gamepad1ButtonUp=[],n.gamepad1DpadPress=[],n.gamepad1DpadDown=[],n.gamepad1DpadUp=[],n.gamepad1LeftTrigger=[],n.gamepad1RightTrigger=[],n.gamepad2=null,n.gamepad2Type=-1,n.gamepad2ButtonPress=[],n.gamepad2ButtonDown=[],n.gamepad2ButtonUp=[],n.gamepad2DpadPress=[],n.gamepad2DpadDown=[],n.gamepad2DpadUp=[],n.gamepad2LeftTrigger=[],n.gamepad2RightTrigger=[],n.gamepad3=null,n.gamepad3Type=-1,n.gamepad3ButtonPress=[],n.gamepad3ButtonDown=[],n.gamepad3ButtonUp=[],n.gamepad3DpadPress=[],n.gamepad3DpadDown=[],n.gamepad3DpadUp=[],n.gamepad3LeftTrigger=[],n.gamepad3RightTrigger=[],n.gamepad4=null,n.gamepad4Type=-1,n.gamepad4ButtonPress=[],n.gamepad4ButtonDown=[],n.gamepad4ButtonUp=[],n.gamepad4DpadPress=[],n.gamepad4DpadDown=[],n.gamepad4DpadUp=[],n.gamepad4LeftTrigger=[],n.gamepad4RightTrigger=[],n.debugLayerVisible=!1,n}();e.SceneManager=n}(BABYLON||(BABYLON={})),BABYLON.SceneManager.IsWindows()&&"undefined"!=typeof Windows.UI.ViewManagement&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow&&Windows.UI.ViewManagement.ApplicationView.getForCurrentView().setDesiredBoundsMode(Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow),BABYLON.SceneManager.IsXboxOne()&&navigator.gamepadInputEmulation&&(navigator.gamepadInputEmulation="gamepad");var BABYLON;!function(e){var n=function(){function n(e,n){void 0===n&&(n=null),this._babylonScene=e,this._gltfLoader=n,this._disposeList=[],this._detailList=[],this._physicList=[],this._shadowList=[],this._scriptList=[]}return Object.defineProperty(n.prototype,"loader",{get:function(){return this._gltfLoader},enumerable:!0,configurable:!0}),n.prototype.parseSceneComponents=function(n){e.MetadataParser.DoParseSceneComponents(this._babylonScene,n,this._physicList,this._shadowList,this._scriptList)},n.prototype.postProcessSceneComponents=function(){e.MetadataParser.DoProcessPendingDetails(this._babylonScene,this._detailList),e.MetadataParser.DoProcessPendingPhysics(this._babylonScene,this._physicList),e.MetadataParser.DoProcessPendingShadows(this._babylonScene,this._shadowList),e.MetadataParser.DoProcessPendingScripts(this._babylonScene,this._scriptList),e.MetadataParser.DoProcessPendingDisposes(this._disposeList),this._babylonScene=null,this._disposeList=null,this._detailList=null,this._physicList=null,this._shadowList=null,this._scriptList=null},n.prototype.addDetailLevelItem=function(e){this._detailList.push(e)},n.prototype.addDisposeEntityItem=function(e){this._disposeList.push(e)},n.prototype.loadFloatAccessorData=function(n,t){if(null==this._gltfLoader)return Promise.resolve(null);var a=e.GLTF2.ArrayItem.Get(n,this._gltfLoader.gltf.accessors,t);return this._gltfLoader._loadFloatAccessorAsync("/accessors/"+t,a)},n.prototype.loadIndicesAccessorData=function(n,t){if(null==this._gltfLoader)return Promise.resolve(null);var a=e.GLTF2.ArrayItem.Get(n,this._gltfLoader.gltf.accessors,t);return this._gltfLoader._loadIndicesAccessorAsync("/accessors/"+t,a)},n.DoParseSceneComponents=function(n,t,a,r,i){if(null!=t&&null!=t.metadata&&null!=t.metadata.unity&&null!=t.metadata.unity.parsed&&t.metadata.unity.parsed===!1){t.metadata.parsed=!0;var o=t.metadata.unity;t.onDisposeObservable.addOnce(function(){e.Utilities.DisposeEntity(t)}),t.metadata.clone=function(){return e.Utilities.CloneMetadata(t.metadata)};var s=t instanceof e.AbstractMesh,l=o.tags;if(null!=l&&""!==l&&(e.Tags.AddTagsTo(t,l),l.indexOf("NavigationMesh")>=0&&(t.isVisible=!1)),null!=o.physics&&null!=a&&a.push(t),null!=o.renderer)if(s===!0)null!=o.renderer.castshadows&&o.renderer.castshadows===!0&&null!=r&&r.push(t),null!=o.renderer.receiveshadows&&o.renderer.receiveshadows===!0&&(t.receiveShadows=!0),null!=o.renderer.checkcollisions&&o.renderer.checkcollisions===!0&&(t.checkCollisions=!0);else{var u=e.SceneManager.GetPrimitiveMeshes(t);null!=u&&u.length>0&&u.forEach(function(e){null!=o.renderer.castshadows&&o.renderer.castshadows===!0&&null!=r&&r.push(e),null!=o.renderer.receiveshadows&&o.renderer.receiveshadows===!0&&(e.receiveShadows=!0),null!=o.renderer.checkcollisions&&o.renderer.checkcollisions===!0&&(e.checkCollisions=!0)})}if(null!=o.components){var c=o.components;null!=c&&c.length>0&&c.forEach(function(a){if(null!=a)switch(a.alias){case"script":null!=i&&i.push({mesh:t,comp:a});break;case"camera":e.MetadataParser.SetupCameraComponent(n,t,a);break;case"light":e.MetadataParser.SetupLightComponent(n,t,a)}})}}},n.DoProcessPendingDisposes=function(e){null!=e&&e.length>0&&e.forEach(function(e){e.dispose(!1)})},n.DoProcessPendingDetails=function(n,t){null!=t&&t.length>0&&t.forEach(function(t){if(null!=t.metadata&&null!=t.metadata.unity&&null!=t.metadata.unity.lods){var a=t.metadata.unity.lods,r=t.isEnabled(!1),i=t;if(null!=t.metadata.unity.distances){var o=t.metadata.unity.distances;if(o.length>=a.length){var s=o.length>a.length?o[o.length-1]:0;i.setEnabled(!1);for(var l=0;l<a.length;l++){var u=a[l],c=n.getMeshByID(u);null!=c&&i.addLODLevel(o[l],c)}s>0&&i.addLODLevel(s,null),r===!0&&i.setEnabled(!0)}else e.Tools.Warn("Invalid level of detail distances for "+t.name)}else null!=t.metadata.unity.coverages}})},n.DoProcessPendingPhysics=function(n,t){if(null!=t&&t.length>0){var a=n.isPhysicsEnabled(),r=a===!0?n.getPhysicsEngine():null,i=a===!0&&null!=r&&"AmmoJSPlugin"===r.getPhysicsPluginName();i===!0?t.forEach(function(t){e.MetadataParser.SetupPhysicsComponent(n,t)}):e.Tools.Warn("Ammo.js physics engine not loaded. Physics impostors will not be created.")}},n.DoProcessPendingShadows=function(e,n){null!=n&&n.length>0&&null!=e.lights&&e.lights.length>0&&e.lights.forEach(function(e){if(null!=e._shadowGenerator&&null!=e.metadata&&null!=e.metadata.unity&&e.metadata.unity.generator===!0){var t=e._shadowGenerator,a=t.getShadowMap();null!=a&&(null==a.renderList&&(a.renderList=[]),n.forEach(function(e){a.renderList.push(e)}))}})},n.DoProcessPendingScripts=function(n,t){if(null!=t&&t.length>0){var a=[];t.sort(function(e,n){return e.comp.order<n.comp.order?-1:e.comp.order>n.comp.order?1:0}),t.forEach(function(t){if(null!=t.comp.klass&&""!==t.comp.klass&&"BABYLON.ScriptComponent"!==t.comp.klass){var r=e.Utilities.InstantiateClass(t.comp.klass);if(null!=r){var i=new r(t.mesh,n,t.comp.properties);if(null!=i){var o=i instanceof e.ScriptComponent;o===!0?(t.comp.instance=i,a.push(t.comp.instance)):e.Tools.Warn("Non script component instantiated class: "+t.comp.klass)}else e.Tools.Warn("Failed to instantiate script class: "+t.comp.klass)}else e.Tools.Warn("Failed to locate script class: "+t.comp.klass)}}),null!=a&&a.length>0&&a.forEach(function(n){e.SceneManager.RegisterScriptComponent(n,!1)}),a=null}},n.SetupPhysicsComponent=function(n,t){var a=null!=t.metadata&&null!=t.metadata.unity?t.metadata.unity:null;if(null!=a&&null!=a.physics){t.checkCollisions=!1;var r=null!=a.physics.mass?a.physics.mass:0,i=null!=a.physics.center?e.Utilities.ParseVector3(a.physics.center,e.Vector3.Zero()):e.Vector3.Zero();if("rigidbody"===a.physics.type)if(e.SceneManager.DebugPhysics&&e.Tools.Log("Initialize rigidbody physics for: "+t.name),null!=a.collision&&null!=a.collision.type&&"MeshCollider"===a.collision.type){var o=e.PhysicsImpostor.MeshImpostor,s=null!=a.collision.convexmesh&&a.collision.convexmesh,l=null!=a.collision.impersonatemesh?a.collision.impersonatemesh:"DefaultImpostor",u=null!=a.collision.dynamicfriction?a.collision.dynamicfriction:.6,c=(null!=a.collision.staticfriction?a.collision.staticfriction:.6,null!=a.collision.restitution?a.collision.restitution:0),p=null!=a.collision.debugging&&a.collision.debugging,d=null!=a.collision.trigger&&a.collision.trigger;o="BoxImpostor"===l?e.PhysicsImpostor.BoxImpostor:"PlaneImpostor"===l?e.PhysicsImpostor.PlaneImpostor:"SphereImpostor"===l?e.PhysicsImpostor.SphereImpostor:"CylinderImpostor"===l?e.PhysicsImpostor.CylinderImpostor:s===!0?e.PhysicsImpostor.ConvexHullImpostor:e.PhysicsImpostor.MeshImpostor,e.SceneManager.DebugPhysics&&e.Tools.Log("Setup "+e.Utilities.FormatPhysicsImposterType(o).toLowerCase()+" entity imposter for: "+t.name),e.MetadataParser.CreateEntityPhysicsImpostor(n,t,o,{mass:r,friction:u,restitution:c}),e.MetadataParser.SetupRigidbodyPhysicsFunction(n,t,!1,d,a.physics,p)}else{var g=0,m=0,h=0,f=0,S=!1,y=0,M=t.getChildMeshes(!0);null!=M&&M.length>0&&M.forEach(function(t){if(null!=t.metadata&&null!=t.metadata.unity&&null!=t.metadata.unity.collision){t.position.subtractInPlace(i);var r=t.metadata.unity.collision,o=e.PhysicsImpostor.BoxImpostor,s=null!=r.convexmesh&&r.convexmesh,l=null!=r.impersonatemesh?r.impersonatemesh:"DefaultImpostor",u=null!=r.dynamicfriction?r.dynamicfriction:.6,c=null!=r.staticfriction?r.staticfriction:.6,p=null!=r.restitution?r.restitution:0,d=null!=r.debugging&&r.debugging,M=null!=r.trigger&&r.trigger,v=null!=r.type?r.type:"BoxCollider";"MeshCollider"===v?o="BoxImpostor"===l?e.PhysicsImpostor.BoxImpostor:"PlaneImpostor"===l?e.PhysicsImpostor.PlaneImpostor:"SphereImpostor"===l?e.PhysicsImpostor.SphereImpostor:"CylinderImpostor"===l?e.PhysicsImpostor.CylinderImpostor:s===!0?e.PhysicsImpostor.ConvexHullImpostor:e.PhysicsImpostor.MeshImpostor:"WheelCollider"===v?o=e.PhysicsImpostor.CylinderImpostor:"CapsuleCollider"===v?o=e.PhysicsImpostor.CylinderImpostor:"CharacterController"===v?o=e.PhysicsImpostor.CylinderImpostor:"SphereCollider"===v?o=e.PhysicsImpostor.SphereImpostor:"BoxCollider"===v&&(o=e.PhysicsImpostor.BoxImpostor),
u>g&&(g=u),c>m&&(m=c),p>h&&(h=p),d===!0&&(f=1),1==M&&(S=!0),e.SceneManager.DebugPhysics&&e.Tools.Log("Setup "+e.Utilities.FormatPhysicsImposterType(o).toLowerCase()+" child imposter for: "+t.name),e.MetadataParser.CreateEntityPhysicsImpostor(n,t,o,{mass:0,friction:0,restitution:0}),e.MetadataParser.SetupRigidbodyPhysicsFunction(n,t,!0,!1,a.physics,d),y++}}),y>0&&(e.SceneManager.DebugPhysics&&e.Tools.Log("Setup physics root no imposter for: "+t.name),e.MetadataParser.CreateEntityPhysicsImpostor(n,t,e.PhysicsImpostor.NoImpostor,{mass:r,friction:g,restitution:h}),e.MetadataParser.SetupRigidbodyPhysicsFunction(n,t,!1,S,a.physics,1===f)),M=null}}},n.SetupCameraComponent=function(n,t,a){var r=t.name+"_rig",i=n.useRightHandedSystem===!0?Math.PI:0,o=new e.UniversalCamera(r,e.Vector3.Zero(),n);o.parent=t,o.rotation=new e.Vector3(0,i,0),o.checkCollisions=!1,t.checkCollisions=!1;var s=null!=a.maincamera&&a.maincamera;s===!0&&null==n.activeCamera&&(n.activeCamera=o);var l=null!=a.type?a.type:0;switch(l){case 0:o.mode=e.Camera.PERSPECTIVE_CAMERA,null!=a.perspectiveyfov&&(o.fov=a.perspectiveyfov),null!=a.perspectiveznear&&(o.minZ=a.perspectiveznear),null!=a.perspectivezfar&&(o.maxZ=a.perspectivezfar);break;case 1:o.mode=e.Camera.ORTHOGRAPHIC_CAMERA,null!=a.orthoxmag&&(o.orthoLeft=-a.orthoxmag,o.orthoRight=a.orthoxmag),null!=a.orthoymag&&(o.orthoBottom=-a.orthoymag,o.orthoTop=a.orthoymag),null!=a.orthoznear&&(o.minZ=a.orthoznear),null!=a.orthozfar&&(o.maxZ=a.orthozfar)}t.cameraRig=o},n.SetupLightComponent=function(n,t,a){var r,i=t.name+"_rig";t.checkCollisions=!1;var o=1,s=null!=a.type?a.type:0;switch(s){case 0:var l=n.useRightHandedSystem===!0?e.Vector3.Backward():e.Vector3.Forward(),u=null!=a.orthoscale?a.orthoscale:.1,c=new e.DirectionalLight(i,l,n);c.shadowOrthoScale=u,r=c,r.falloffType=e.Light.FALLOFF_STANDARD,o=2.66;break;case 1:var p=r=new e.PointLight(i,e.Vector3.Zero(),n);r=p,r.falloffType=e.Light.FALLOFF_STANDARD,o=1;break;case 2:var l=n.useRightHandedSystem===!0?e.Vector3.Backward():e.Vector3.Forward(),d=null!=a.spotangle?a.spotangle:Math.PI/4,g=new e.SpotLight(i,e.Vector3.Zero(),l,0,1,n);g.angle=d*e.System.Deg2Rad*.966,g.innerAngle=.8*g.angle,r=g,r.falloffType=e.Light.FALLOFF_GLTF,o=6.66}if(null!=r){r.parent=t,r.range=null!=a.range?a.range:Number.MAX_VALUE,r.diffuse=null!=a.color?e.Utilities.ParseColor3(a.color):e.Color3.White(),r.intensity=(null!=a.intensity?a.intensity:1)*o,r.lightmapMode=null!=a.lightmapmode?a.lightmapmode:e.Light.LIGHTMAP_DEFAULT,r.intensityMode=e.Light.INTENSITYMODE_AUTOMATIC,r.shadowEnabled=!1;var m=null!=a.softshadows&&a.softshadows,h=null!=a.shadowmapsize?a.shadowmapsize:512,f=null!=a.generateshadows&&a.generateshadows,S=null!=a.hardshadowfilter?a.hardshadowfilter:"None",y=null!=a.softshadowfilter?a.softshadowfilter:"None",M=null!=a.biasscalefactor?a.biasscalefactor:.01,v=null!=a.shadowmapbias?a.shadowmapbias:.05,_=null!=a.normalmapbias?a.normalmapbias:.4,b=null!=a.shadowstrength?a.shadowstrength:1,x=null!=a.shadowdistance?a.shadowdistance:40,P=null!=a.shadownearplane?a.shadownearplane:.2,T=null!=a.shadowdepthscale?a.shadowdepthscale:50,B=null!=a.contacthardening?a.contacthardening:.1,O=null==a.usekernelblur||a.usekernelblur,C=null!=a.shadowblurkernel?a.shadowblurkernel:1,k=null!=a.shadowblurscale?a.shadowblurscale:2,A=null!=a.shadowbluroffset?a.shadowbluroffset:1,w=null!=a.shadowfilterquality?a.shadowfilterquality:"Medium",L=null!=a.transparencyshadow&&a.transparencyshadow,I=null==a.forcebackfacesonly||a.forcebackfacesonly,U=null!=a.frustumedgefalloff?a.frustumedgefalloff:0;if(f===!0){var N=r,F=new e.ShadowGenerator(h,N,(!0));if(N.shadowEnabled=!0,N.shadowMinZ=P,N.shadowMaxZ=x,F.bias=v*M,F.normalBias=_*M,F.depthScale=T,F.setDarkness(1-e.Scalar.Clamp(.9*b)),F.useKernelBlur=O,F.blurKernel=C,F.blurScale=k,F.blurBoxOffset=A,F.frustumEdgeFalloff=U,F.forceBackFacesOnly=I,F.setTransparencyShadow(L),F.contactHardeningLightSizeUVRatio=B,m===!0)switch(y){case"PoissonSampling":F.usePoissonSampling=!0;break;case"BlurExponentialShadowMap":F.useBlurExponentialShadowMap=!0;break;case"BlurCloseExponentialShadowMap":F.useBlurCloseExponentialShadowMap=!0;break;case"PercentageCloserFiltering":F.usePercentageCloserFiltering=!0;break;case"ContactHardeningShadowMap":F.useContactHardeningShadow=!0}else switch(S){case"ExponentialShadowMap":F.useExponentialShadowMap=!0;break;case"CloseExponentialShadowMap":F.useCloseExponentialShadowMap=!0}switch(w){case"High":F.filteringQuality=e.ShadowGenerator.QUALITY_HIGH;break;case"Medium":F.filteringQuality=e.ShadowGenerator.QUALITY_MEDIUM;break;case"Low":F.filteringQuality=e.ShadowGenerator.QUALITY_LOW}null==r.metadata&&(r.metadata={}),null==r.metadata.unity&&(r.metadata.unity={}),r.metadata.unity.generator=!0}t.lightRig=r}},n.CreateEntityPhysicsImpostor=function(n,t,a,r,i){if(void 0===i&&(i=!0),null!=t){var o=t.parent;i===!0&&(t.parent=null),t.physicsImpostor=new e.PhysicsImpostor(t,a,r,n),i===!0&&(t.parent=o)}},n.SetupRigidbodyPhysicsFunction=function(n,t,a,r,i,o){null!=t&&(null!=t.physicsImpostor?(t.physicsImpostor.executeNativeFunction(function(n,a){var o=null==i||null==i.gravity||i.gravity;if(o===!1&&(a.setGravity?a.setGravity(new Ammo.btVector3(0,0,0)):e.Tools.Warn("Physics engine set gravity override not supported for: "+t.name)),a.setDamping){var s=null!=i&&null!=i.ldrag?i.ldrag:0,l=null!=i&&null!=i.adrag?i.adrag:.05;a.setDamping(s,l)}else e.Tools.Warn("Physics engine set drag damping not supported for: "+t.name);a.setCollisionFlags&&a.getCollisionFlags?r===!0&&a.setCollisionFlags(a.getCollisionFlags()|e.CollisionFlags.CF_NO_CONTACT_RESPONSE):e.Tools.Warn("Physics engine set collision flags not supported for: "+t.name);var u=null!=i&&null!=i.freeze?i.freeze:null;if(null!=u){if(a.setLinearFactor){var c=null!=u.positionx&&u.positionx===!0?0:1,p=null!=u.positiony&&u.positiony===!0?0:1,d=null!=u.positionz&&u.positionz===!0?0:1;a.setLinearFactor(new Ammo.btVector3(c,p,d))}else e.Tools.Warn("Physics engine set linear factor not supported for: "+t.name);if(a.setAngularFactor){var g=null!=u.rotationx&&u.rotationx===!0?0:1,m=null!=u.rotationy&&u.rotationy===!0?0:1,h=null!=u.rotationz&&u.rotationz===!0?0:1;a.setAngularFactor(new Ammo.btVector3(g,m,h))}else e.Tools.Warn("Physics engine set angular factor not supported for: "+t.name)}}),o===!0&&e.SceneManager.ShowEntityPhysicsImpostor(n,t)):e.Tools.Warn("No valid physics impostor to setup for "+t.name))},n}();e.MetadataParser=n}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}(),BABYLON;!function(e){var n=function(){function n(n,t,a){if(void 0===a&&(a={}),this._before=null,this._after=null,this._properties=null,this._started=!1,this._scene=null,this._transform=null,null==n)throw new Error("Null transform object specified.");if(null==t)throw new Error("Null host scene object specified.");this._scene=t,this._transform=n,this._properties=a||{};var r=this;r._before=function(){e.ScriptComponent.BeforeInstance(r)},r._after=function(){e.ScriptComponent.AfterInstance(r)},r.registerComponentInstance&&r.destroyComponentInstance||e.Tools.Warn("Invalid component registration handlers for: "+this._transform.name)}return n.prototype.start=function(){},n.prototype.update=function(){},n.prototype.after=function(){},n.prototype.destroy=function(){},Object.defineProperty(n.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0}),n.prototype.getClassName=function(){var e=/function (.{1,})\(/,n=e.exec(this.constructor.toString());return n&&n.length>1?n[1]:""},n.prototype.setProperty=function(e,n){null==this._properties&&(this._properties={}),this._properties[e]=n},n.prototype.getProperty=function(e,n){void 0===n&&(n=null);var t=null;return null!=this._properties&&(t=this._properties[e]),null==t&&(t=n),null!=t?t:null},n.prototype.getTransformMesh=function(){return this._transform instanceof e.Mesh?this._transform:null},n.prototype.getAbstractMesh=function(){return this._transform instanceof e.AbstractMesh?this._transform:null},n.prototype.getCollisionMeshes=function(){return e.SceneManager.GetCollisionMeshes(this.transform)},n.prototype.getPrimitiveMeshes=function(){return e.SceneManager.GetPrimitiveMeshes(this.transform)},n.prototype.getMetadata=function(){return e.SceneManager.FindSceneMetadata(this._transform)},n.prototype.getComponent=function(n){var t=e.SceneManager.FindScriptComponent(this._transform,n);return null!=t?t:null},n.prototype.getComponents=function(n){var t=e.SceneManager.FindScriptComponents(this._transform,n);return null!=t?t:null},n.prototype.getParticleRig=function(){return e.SceneManager.FindSceneParticleRig(this._transform)},n.prototype.getCameraRig=function(){return e.SceneManager.FindSceneCameraRig(this._transform)},n.prototype.getLightRig=function(){return e.SceneManager.FindSceneLightRig(this._transform)},n.prototype.getFlareRig=function(){return e.SceneManager.FindSceneFlareRig(this._transform)},n.prototype.getChildMesh=function(n,t,a,r){return void 0===t&&(t=e.SearchType.StartsWith),void 0===a&&(a=!0),void 0===r&&(r=null),e.SceneManager.FindSceneChildMesh(this._transform,n,t,a,r)},n.prototype.getChildTransform=function(n,t,a,r){return void 0===t&&(t=e.SearchType.StartsWith),void 0===a&&(a=!0),void 0===r&&(r=null),e.SceneManager.FindSceneChildTransform(this._transform,n,t,a,r)},n.prototype.getDeltaSeconds=function(){return e.SceneManager.GetDeltaSeconds(this._scene)},n.prototype.registerComponentInstance=function(n,t){if(void 0===t&&(t=!0),t===!0){e.Utilities.ValidateTransformMetadata(this._transform);var a={alias:"script",order:0,klass:this.getClassName(),properties:null,instance:n};null==this._transform.metadata.unity.components&&(this._transform.metadata.unity.components=[]),this._transform.metadata.unity.components.push(a)}e.ScriptComponent.RegisterInstance(n)},n.prototype.destroyComponentInstance=function(n){e.ScriptComponent.DestroyInstance(n)},n.RegisterInstance=function(e){null!=e&&(null!=e._before&&e.scene.registerBeforeRender(e._before),null!=e._after&&e.scene.registerAfterRender(e._after))},n.BeforeInstance=function(e){null!=e&&(e._started?null!=e._before&&e._started&&e.update():(e.start(),e._started=!0))},n.AfterInstance=function(e){null!=e&&null!=e._after&&e._started&&e.after()},n.DestroyInstance=function(e){if(null!=e&&null!=e.transform){e.scene.unregisterBeforeRender(e._before),e.scene.unregisterAfterRender(e._after);try{e.destroy()}catch(n){}e._transform=null,e._properties=null,e._started=!1,e._before=null,e._after=null,e._scene=null}},n}();e.ScriptComponent=n;var t=function(e){function n(n,t,a){return void 0===a&&(a={}),e.call(this,n,t,a)||this}return __extends(n,e),n.prototype.start=function(){},n.prototype.update=function(){},n.prototype.after=function(){},n.prototype.destroy=function(){},n}(e.ScriptComponent);e.ShurikenParticleSystem=t;var a=function(e){function n(n,t,a){return void 0===a&&(a={}),e.call(this,n,t,a)||this}return __extends(n,e),n.prototype.start=function(){},n.prototype.update=function(){},n.prototype.after=function(){},n.prototype.destroy=function(){},n}(e.ScriptComponent);e.CharacterController=a;var r=function(e){function n(n,t,a){return void 0===a&&(a={}),e.call(this,n,t,a)||this}return __extends(n,e),n.prototype.start=function(){},n.prototype.update=function(){},n.prototype.after=function(){},n.prototype.destroy=function(){},n}(e.ScriptComponent);e.AnimationState=r;var i=function(n){function t(e,t,a){return void 0===a&&(a={}),n.call(this,e,t,a)||this}return __extends(t,n),Object.defineProperty(t.prototype,"info",{get:function(){return this._info},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasAgentInfo",{get:function(){return null!=this.info},enumerable:!0,configurable:!0}),t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.after=function(){},t.prototype.destroy=function(){},t.prototype.setDestination=function(n){this.hasAgentInfo||e.Tools.Warn("Null navigation agent metadata. Set agent destination ignored.")},t}(e.ScriptComponent);e.NavigationAgent=i}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}(),__decorate=this&&this.__decorate||function(e,n,t,a){var r,i=arguments.length,o=i<3?n:null===a?a=Object.getOwnPropertyDescriptor(n,t):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,n,t,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(i<3?r(o):i>3?r(n,t,o):r(n,t))||o);return i>3&&o&&Object.defineProperty(n,t,o),o},BABYLON;!function(e){var n=function(){function e(){this._defines={},this._defines={}}return e.prototype.getDefines=function(){return this._defines},e.prototype.defineBoolean=function(e){this._defines[e]=!0},e.prototype.defineNumeric=function(e,n){this._defines[e]=n},e.ShaderIndexer=0,e}();e.UniversalShaderDefines=n;var t=function(e){function n(){var n=e.call(this)||this;return n.DIFFUSE=!1,n.CLIPPLANE=!1,n.CLIPPLANE2=!1,n.CLIPPLANE3=!1,n.CLIPPLANE4=!1,n.ALPHATEST=!1,n.DEPTHPREPASS=!1,n.POINTSIZE=!1,n.FOG=!1,n.NORMAL=!1,n.UV1=!1,n.UV2=!1,n.VERTEXCOLOR=!1,n.VERTEXALPHA=!1,n.NUM_BONE_INFLUENCERS=0,n.BonesPerMesh=0,n.INSTANCES=!1,n.rebuild(),n}return __extends(n,e),n}(e.MaterialDefines);e.UniversalMaterialDefines=t;var a=function(){function e(){}return e}();e.UniversalAlbedoChunks=a;var r=function(){function e(){}return e}();e.UniversalDiffuseChunks=r;var i=function(){function n(){}return n.Initialize=function(n,t){void 0===t&&(t=!0);var a=n,r=e.Utilities.HasOwnProperty(a,"getShaderName")?a.getShaderName():"glsl",i=!!e.Utilities.HasOwnProperty(a,"getAlphaBlending")&&a.getAlphaBlending(),o=!!e.Utilities.HasOwnProperty(a,"getAlphaTesting")&&a.getAlphaTesting(),s=e.Utilities.HasOwnProperty(a,"getDefaultDefines")?a.getDefaultDefines():null,l=e.Utilities.HasOwnProperty(a,"getDefaultAttributes")?a.getDefaultAttributes():null,u=e.Utilities.HasOwnProperty(a,"getDefaultUniforms")?a.getDefaultUniforms():null;(null==s||s.length<=0)&&(s=["#define DIFFUSECOLOR","#define DIFFUSETEXTURE"]),(null==l||l.length<=0)&&(l=["position","normal","uv","uv2","color"]),(null==u||u.length<=0)&&(u=["world","worldView","worldViewProjection","view","projection","viewProjection","diffuseColor","diffuseTexture","diffuseTextureInfos","diffuseTextureMatrix"]);var c={vertex:r,fragment:r},p={needAlphaBlending:i,needAlphaTesting:o,attributes:l,uniforms:u,defines:s,samplers:[],uniformBuffers:[]};a._shaderPath=c,a._options=p,t===!0&&(a.fn_afterBind=a._afterBind,a._afterBind=function(e){var t=n.getScene();if(t.texturesEnabled)for(var r in a._textures){var i=a._textures[r];null!=i&&(a._effect.setFloat2(r+"Infos",i.coordinatesIndex,i.level),a._effect.setMatrix(r+"Matrix",i.getTextureMatrix()))}if(a.fn_afterBind)try{a.fn_afterBind(e)}catch(o){}})},n}();e.UniversalShaderMaterial=i;var o=function(n){function t(t,a){var r=n.call(this,t,a)||this;return r.diffuseColor=new e.Color3(1,1,1),r._disableLighting=!1,r._maxSimultaneousLights=4,r.locals=null,r._defines=null,r._uniforms=[],r._samplers=[],r._textures={},r._vectors4={},r._floats={},r.locals=new e.UniversalShaderDefines,r._defines=null,r.customShaderNameResolve=r._buildCustomShader,r}return __extends(t,n),t.prototype.getClassName=function(){return"UniversalPushMaterial"},t.prototype.getShaderName=function(){return"simple"},t.prototype.getShaderDefines=function(){return this._defines},t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.getTexture=function(e){return this._textures[e]},t.prototype.getVector4=function(e){return this._vectors4[e]},t.prototype.getFloat=function(e){return this._floats[e]},t.prototype.setTexture=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkSampler(e),this._textures[e]=n,this},t.prototype.setVector4=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkUniform(e),this._vectors4[e]=n,this},t.prototype.setFloat=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkUniform(e),this._floats[e]=n,this},t.prototype.checkUniform=function(e){this._uniforms.indexOf(e)===-1&&(this._uniforms.push(e),this.locals.defineBoolean(e.toUpperCase()))},t.prototype.checkSampler=function(e){this._samplers.indexOf(e)===-1&&(this._samplers.push(e),this.locals.defineBoolean(e.toUpperCase()),this.checkUniform(e+"Infos"),this.checkUniform(e+"Matrix"))},t.prototype.isReadyForSubMesh=function(n,t,a){if(this.isFrozen&&this._wasPreviouslyReady&&t.effect)return!0;t._materialDefines||(t._materialDefines=new e.UniversalMaterialDefines);var r=t._materialDefines,i=this.getScene();if(!this.checkReadyOnEveryCall&&t.effect&&this._renderId===i.getRenderId())return!0;var o=i.getEngine();if(r._areTexturesDirty&&(r._needUVs=!1,i.texturesEnabled&&this._diffuseTexture&&e.MaterialFlags.DiffuseTextureEnabled)){if(!this._diffuseTexture.isReady())return!1;r._needUVs=!0,r.DIFFUSE=!0}if(e.MaterialHelper.PrepareDefinesForMisc(n,i,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(n),r),r._needNormals=e.MaterialHelper.PrepareDefinesForLights(i,n,r,!1,this._maxSimultaneousLights,this._disableLighting),e.MaterialHelper.PrepareDefinesForFrameBoundValues(i,o,r,!!a),e.MaterialHelper.PrepareDefinesForAttributes(n,r,!0,!0),r.isDirty){r.markAsProcessed(),i.resetCachedMaterial();var s=new e.EffectFallbacks;r.FOG&&s.addFallback(1,"FOG"),e.MaterialHelper.HandleFallbacksForShadows(r,s,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&s.addCPUSkinningFallback(0,n);var l=[e.VertexBuffer.PositionKind];r.NORMAL&&l.push(e.VertexBuffer.NormalKind),r.UV1&&l.push(e.VertexBuffer.UVKind),r.UV2&&l.push(e.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&l.push(e.VertexBuffer.ColorKind),e.MaterialHelper.PrepareAttributesForBones(l,n,r,s),e.MaterialHelper.PrepareAttributesForInstances(l,r);var u=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","diffuseMatrix"],c=["diffuseSampler"],p=new Array;e.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:u,uniformBuffersNames:p,samplers:c,defines:r,maxSimultaneousLights:this.maxSimultaneousLights});var d=this.getShaderName();this.customShaderNameResolve&&(d=this.customShaderNameResolve(d,u,p,c,r));var g=r.toString();t.setEffect(i.getEngine().createEffect(d,{attributes:l,uniformsNames:u,uniformBuffersNames:p,samplers:c,defines:g,fallbacks:s,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights-1}},o),r)}return!(!t.effect||!t.effect.isReady())&&(this._renderId=i.getRenderId(),this._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(n,t,a){var r=this.getScene(),i=a._materialDefines;if(i){var o=a.effect;o&&(this._activeEffect=o,this.bindOnlyWorldMatrix(n),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),e.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,o)&&(this._diffuseTexture&&e.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this._diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this._diffuseTexture.getTextureMatrix())),e.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),e.MaterialHelper.BindEyePosition(o,r)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),r.lightsEnabled&&!this.disableLighting&&e.MaterialHelper.BindLights(r,t,this._activeEffect,i,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==e.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),e.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect),this._attachAfterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture);for(var n in this._textures){var t=this._textures[n];t&&t.animations&&t.animations.length>0&&e.push(t)}return e},t.prototype.getActiveTextures=function(){var e=n.prototype.getActiveTextures.call(this);this._diffuseTexture&&e.push(this._diffuseTexture);for(var t in this._textures){var a=this._textures[t];a&&e.push(a)}return e},t.prototype.hasTexture=function(e){if(n.prototype.hasTexture.call(this,e))return!0;if(this.diffuseTexture===e)return!0;var t=!1;for(var a in this._textures){var r=this._textures[a];if(r===r){t=!0;break}}return t},t.prototype.dispose=function(e){this._diffuseTexture&&this._diffuseTexture.dispose();for(var t in this._textures){var a=this._textures[t];a&&a.dispose(),this._textures[t]=null}this._textures={},n.prototype.dispose.call(this,e)},t.prototype.clone=function(n){var t,a=this,r=e.SerializationHelper.Clone(function(){return new e.UniversalPushMaterial(n,a.getScene())},this);r._textures={};for(t in this._textures){var i=this._textures[t];i&&r.setTexture(t,i.clone(),!0)}r._vectors4={};for(t in this._vectors4)r.setVector4(t,this._vectors4[t].clone(),!0);r._floats={};for(t in this._floats)r.setFloat(t,this._floats[t],!0);return r},t.prototype.serialize=function(){var n,t=e.SerializationHelper.Serialize(this);t.customType="BABYLON.UniversalPushMaterial",t.textures={};for(n in this._textures){var a=this._textures[n];a&&(t.textures[n]=a.serialize())}t.vectors4={};for(n in this._vectors4)t.vectors4[n]=this._vectors4[n].asArray();t.floats={};for(n in this._floats)t.floats[n]=this._floats[n];return t},t.Parse=function(n,t,a){var r,i=e.SerializationHelper.Parse(function(){return new e.UniversalPushMaterial(n.name,t)},n,t,a);for(r in n.textures){var o=n.textures[r];o&&i.setTexture(r,e.Texture.Parse(o,t,a),!0)}for(r in n.vectors4)i.setVector4(r,e.Vector4.FromArray(n.vectors4[r]),!0);for(r in n.floats)i.setFloat(r,n.floats[r],!0);return i},t.prototype._buildCustomShader=function(e,n,t,a,r){this._defines=r;var i=this.getShaderName();null!=i&&""!==i||(i=e),null!=i&&""!==i||(i="simple");var o=this.locals.getDefines();if(null!=o&&null!=this._defines){var s=Object.keys(o);if(null!=s&&s.length>0){for(var l=this._defines,u=0,c=s;u<c.length;u++){var p=c[u];l[p]=o[p]}this._defines.rebuild()}}var d=0;if(null!=this._uniforms&&this._uniforms.length>0)for(d=0;d<this._uniforms.length;d++){var g=this._uniforms[d];n.indexOf(g)===-1&&n.push(g)}if(d=0,null!=this._samplers&&this._samplers.length>0)for(d=0;d<this._samplers.length;d++){var m=this._samplers[d];a.indexOf(m)===-1&&a.push(m)}return i},t.prototype._attachAfterBind=function(e,n){var t,a=this.getScene();if(a.texturesEnabled)for(t in this._textures){var r=this._textures[t];null!=r&&(n.setTexture(t,r),n.setFloat2(t+"Infos",r.coordinatesIndex,r.level),n.setMatrix(t+"Matrix",r.getTextureMatrix()))}for(t in this._vectors4)n.setVector4(t,this._vectors4[t]);for(t in this._floats)n.setFloat(t,this._floats[t])},__decorate([e.serializeAsTexture("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),__decorate([e.expandToProperty("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),__decorate([e.serializeAsColor3("diffuse")],t.prototype,"diffuseColor",void 0),__decorate([e.serialize("disableLighting")],t.prototype,"_disableLighting",void 0),__decorate([e.expandToProperty("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),__decorate([e.serialize("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),__decorate([e.expandToProperty("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(e.PushMaterial);e.UniversalPushMaterial=o,e._TypeStore.RegisteredTypes.UniversalPushMaterial=o;var s=function(n){function t(t,a){var r=n.call(this,t,a)||this;return r.locals=null,r._defines=null,r._uniforms=[],r._samplers=[],r._textures={},r._vectors4={},r._floats={},r.locals=new e.UniversalShaderDefines,r._defines=null,r._enableShaderChunks=!1,r._setupAttachAfterBind(),r._materialShaderChunks=new e.UniversalAlbedoChunks,r.customShaderNameResolve=r._buildCustomShader,r.customShaderChunkResolve(),r}return __extends(t,n),t.prototype.getClassName=function(){return"UniversalAlbedoMaterial"},t.prototype.getShaderName=function(){return"pbr"},t.prototype.getShaderChunk=function(){return null},t.prototype.getShaderDefines=function(){return this._defines},t.prototype.getTexture=function(e){return this._textures[e]},t.prototype.getVector4=function(e){return this._vectors4[e]},t.prototype.getFloat=function(e){return this._floats[e]},t.prototype.setTexture=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkSampler(e),this._textures[e]=n,this},t.prototype.setVector4=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkUniform(e),this._vectors4[e]=n,this},t.prototype.setFloat=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkUniform(e),this._floats[e]=n,this},t.prototype.checkUniform=function(e){this._uniforms.indexOf(e)===-1&&(this._uniforms.push(e),this.locals.defineBoolean(e.toUpperCase()))},t.prototype.checkSampler=function(e){this._samplers.indexOf(e)===-1&&(this._samplers.push(e),this.locals.defineBoolean(e.toUpperCase()),this.checkUniform(e+"Infos"),this.checkUniform(e+"Matrix"))},t.prototype.getAnimatables=function(){var e=n.prototype.getAnimatables.call(this);for(var t in this._textures){var a=this._textures[t];a&&a.animations&&a.animations.length>0&&e.push(a)}return e},t.prototype.getActiveTextures=function(){var e=n.prototype.getActiveTextures.call(this);for(var t in this._textures){var a=this._textures[t];a&&e.push(a)}return e},t.prototype.hasTexture=function(e){if(n.prototype.hasTexture.call(this,e))return!0;var t=!1;for(var a in this._textures){var r=this._textures[a];if(r===r){t=!0;break}}return t},t.prototype.dispose=function(e,t){if(t)for(var a in this._textures){var r=this._textures[a];r&&r.dispose(),this._textures[a]=null}this._textures={},n.prototype.dispose.call(this,e,t)},t.prototype.clone=function(n){var t,a=this,r=e.SerializationHelper.Clone(function(){return new e.UniversalAlbedoMaterial(n,a.getScene())},this);r._textures={};for(t in this._textures){var i=this._textures[t];i&&r.setTexture(t,i.clone(),!0)}r._vectors4={};for(t in this._vectors4)r.setVector4(t,this._vectors4[t].clone(),!0);r._floats={};for(t in this._floats)r.setFloat(t,this._floats[t],!0);return r},t.prototype.serialize=function(){var n,t=e.SerializationHelper.Serialize(this);t.customType="BABYLON.UniversalAlbedoMaterial",t.textures={};for(n in this._textures){var a=this._textures[n];a&&(t.textures[n]=a.serialize())}t.vectors4={};for(n in this._vectors4)t.vectors4[n]=this._vectors4[n].asArray();t.floats={};for(n in this._floats)t.floats[n]=this._floats[n];return t},t.Parse=function(n,t,a){var r,i=e.SerializationHelper.Parse(function(){return new e.UniversalAlbedoMaterial(n.name,t)},n,t,a);for(r in n.textures){var o=n.textures[r];o&&i.setTexture(r,e.Texture.Parse(o,t,a),!0)}for(r in n.vectors4)i.setVector4(r,e.Vector4.FromArray(n.vectors4[r]),!0);for(r in n.floats)i.setFloat(r,n.floats[r],!0);return i},t.prototype.customShaderChunkResolve=function(){var n=this.getShaderChunk();if(null!=n&&""!==n){var t=n+"ShaderChunks";if(null!=e.Effect.ShadersStore[t]){this._enableShaderChunks=!0;var a=e.Effect.ShadersStore[t],r=e.Utilities.HasOwnProperty(a,"VertexBegin")?a.VertexBegin:null;null!=r&&""!==r&&(this._materialShaderChunks.Vertex_Begin=r);var i=e.Utilities.HasOwnProperty(a,"VertexDefinitions")?a.VertexDefinitions:null;null!=i&&""!==i&&(this._materialShaderChunks.Vertex_Definitions=i);var o=e.Utilities.HasOwnProperty(a,"VertexMainBegin")?a.VertexMainBegin:null;null!=o&&""!==o&&(this._materialShaderChunks.Vertex_MainBegin=o);var s=e.Utilities.HasOwnProperty(a,"VertexUpdatePosition")?a.VertexUpdatePosition:null;null!=s&&""!==s&&(this._materialShaderChunks.Vertex_Before_PositionUpdated=s.replace("result","positionUpdated"));var l=e.Utilities.HasOwnProperty(a,"VertexUpdateNormal")?a.VertexUpdateNormal:null;null!=l&&""!==l&&(this._materialShaderChunks.Vertex_Before_NormalUpdated=l.replace("result","normalUpdated"));var u=e.Utilities.HasOwnProperty(a,"VertexMainEnd")?a.VertexMainEnd:null;null!=u&&""!==u&&(this._materialShaderChunks.Vertex_MainEnd=u);var c=e.Utilities.HasOwnProperty(a,"FragmentBegin")?a.FragmentBegin:null;null!=c&&""!==c&&(this._materialShaderChunks.Fragment_Begin=c);var p=e.Utilities.HasOwnProperty(a,"FragmentDefinitions")?a.FragmentDefinitions:null;null!=p&&""!==p&&(this._materialShaderChunks.Fragment_Definitions=p);var d=e.Utilities.HasOwnProperty(a,"FragmentMainBegin")?a.FragmentMainBegin:null;null!=d&&""!==d&&(this._materialShaderChunks.Fragment_MainBegin=d);var g=e.Utilities.HasOwnProperty(a,"FragmentUpdateAlbedo")?a.FragmentUpdateAlbedo:null;null!=g&&""!==g&&(this._materialShaderChunks.Fragment_Custom_Albedo=g.replace("result","surfaceAlbedo"));var m=e.Utilities.HasOwnProperty(a,"FragmentUpdateAlpha")?a.FragmentUpdateAlpha:null;null!=m&&""!==m&&(this._materialShaderChunks.Fragment_Custom_Alpha=m.replace("result","alpha"));var h=e.Utilities.HasOwnProperty(a,"FragmentMetallicRoughness")?a.FragmentMetallicRoughness:null;null!=h&&""!==h&&(this._materialShaderChunks.Fragment_MetallicRoughness=h);var f=e.Utilities.HasOwnProperty(a,"FragmentMicroSurface")?a.FragmentMicroSurface:null;null!=f&&""!==f&&(this._materialShaderChunks.Fragment_MicroSurface=f);var S=e.Utilities.HasOwnProperty(a,"FragmentBeforeLights")?a.FragmentBeforeLights:null;null!=S&&""!==S&&(this._materialShaderChunks.Fragment_Before_Lights=S);var y=e.Utilities.HasOwnProperty(a,"FragmentBeforeFog")?a.FragmentBeforeFog:null;null!=y&&""!==y&&(this._materialShaderChunks.Fragment_Before_Fog=y);var M=e.Utilities.HasOwnProperty(a,"FragmentBeforeFragColor")?a.FragmentBeforeFragColor:null;null!=M&&""!==M&&(this._materialShaderChunks.Fragment_Before_FragColor=M.replace("result","color"))}else e.Tools.Warn("Failed To Locate Shader Chunk Base: "+t)}},t.prototype._buildCustomShader=function(e,n,t,a,r){this._defines=r;var i=this.getShaderName();null!=i&&""!==i||(i=e),null!=i&&""!==i||(i="pbr");var o=this.locals.getDefines();if(null!=o&&null!=this._defines){var s=Object.keys(o);if(null!=s&&s.length>0){for(var l=this._defines,u=0,c=s;u<c.length;u++){var p=c[u];l[p]=o[p]}this._defines.rebuild()}}var d=0;if(null!=this._uniforms&&this._uniforms.length>0)for(d=0;d<this._uniforms.length;d++){var g=this._uniforms[d];n.indexOf(g)===-1&&n.push(g)}if(d=0,null!=this._samplers&&this._samplers.length>0)for(d=0;d<this._samplers.length;d++){var m=this._samplers[d];a.indexOf(m)===-1&&a.push(m)}return this._enableShaderChunks===!0?this._createShaderChunks(i):i},t.prototype._createShaderChunks=function(n){if(this._isCreatedShader)return this._createdShaderName;this._isCreatedShader=!1;var t=this.getShaderChunk();null!=t&&""!==t||(t=n),e.UniversalShaderDefines.ShaderIndexer++;var a=(t+"Custom"+e.UniversalShaderDefines.ShaderIndexer).trim(),r=e.Effect.ShadersStore[n+"VertexShader"],i=e.Effect.ShadersStore[n+"PixelShader"],o=a+"VertexShader";e.Effect.ShadersStore[o]=r.replace("#define CUSTOM_VERTEX_BEGIN",this._materialShaderChunks.Vertex_Begin?this._materialShaderChunks.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",this._materialShaderChunks.Vertex_Definitions?this._materialShaderChunks.Vertex_Definitions:"").replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this._materialShaderChunks.Vertex_MainBegin?this._materialShaderChunks.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this._materialShaderChunks.Vertex_Before_PositionUpdated?this._materialShaderChunks.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this._materialShaderChunks.Vertex_Before_NormalUpdated?this._materialShaderChunks.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",this._materialShaderChunks.Vertex_MainEnd?this._materialShaderChunks.Vertex_MainEnd:"");
var s=a+"PixelShader";return e.Effect.ShadersStore[s]=i.replace("#define CUSTOM_FRAGMENT_BEGIN",this._materialShaderChunks.Fragment_Begin?this._materialShaderChunks.Fragment_Begin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",this._materialShaderChunks.Fragment_Definitions?this._materialShaderChunks.Fragment_Definitions:"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this._materialShaderChunks.Fragment_MainBegin?this._materialShaderChunks.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALBEDO",this._materialShaderChunks.Fragment_Custom_Albedo?this._materialShaderChunks.Fragment_Custom_Albedo:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this._materialShaderChunks.Fragment_Custom_Alpha?this._materialShaderChunks.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_UPDATE_METALLICROUGHNESS",this._materialShaderChunks.Fragment_MetallicRoughness?this._materialShaderChunks.Fragment_MetallicRoughness:"").replace("#define CUSTOM_FRAGMENT_UPDATE_MICROSURFACE",this._materialShaderChunks.Fragment_MicroSurface?this._materialShaderChunks.Fragment_MicroSurface:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this._materialShaderChunks.Fragment_Before_Lights?this._materialShaderChunks.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this._materialShaderChunks.Fragment_Before_Fog?this._materialShaderChunks.Fragment_Before_Fog:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this._materialShaderChunks.Fragment_Before_FragColor?this._materialShaderChunks.Fragment_Before_FragColor:""),this._isCreatedShader=!0,this._createdShaderName=a,a},t.prototype._attachAfterBind=function(e,n){var t,a=this.getScene();if(a.texturesEnabled)for(t in this._textures){var r=this._textures[t];null!=r&&(n.setTexture(t,r),n.setFloat2(t+"Infos",r.coordinatesIndex,r.level),n.setMatrix(t+"Matrix",r.getTextureMatrix()))}for(t in this._vectors4)n.setVector4(t,this._vectors4[t]);for(t in this._floats)n.setFloat(t,this._floats[t])},t.prototype._setupAttachAfterBind=function(){var e=this,n=this._afterBind;this._afterBind=function(t,a){if(e._attachAfterBind(t,a),n)try{n(t,a)}catch(r){}}},t}(e.PBRMaterial);e.UniversalAlbedoMaterial=s,e._TypeStore.RegisteredTypes.UniversalAlbedoMaterial=s;var l=function(n){function t(t,a){var r=n.call(this,t,a)||this;return r.locals=null,r._defines=null,r._uniforms=[],r._samplers=[],r._textures={},r._vectors4={},r._floats={},r.locals=new e.UniversalShaderDefines,r._defines=null,r._enableShaderChunks=!1,r._setupAttachAfterBind(),r._materialShaderChunks=new e.UniversalDiffuseChunks,r.customShaderNameResolve=r._buildCustomShader,r.customShaderChunkResolve(),r}return __extends(t,n),t.prototype.getClassName=function(){return"UniversalDiffuseMaterial"},t.prototype.getShaderName=function(){return"default"},t.prototype.getShaderChunk=function(){return null},t.prototype.getShaderDefines=function(){return this._defines},t.prototype.getTexture=function(e){return this._textures[e]},t.prototype.getVector4=function(e){return this._vectors4[e]},t.prototype.getFloat=function(e){return this._floats[e]},t.prototype.setTexture=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkSampler(e),this._textures[e]=n,this},t.prototype.setVector4=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkUniform(e),this._vectors4[e]=n,this},t.prototype.setFloat=function(e,n,t){return void 0===t&&(t=!1),t===!0&&this.checkUniform(e),this._floats[e]=n,this},t.prototype.checkUniform=function(e){this._uniforms.indexOf(e)===-1&&(this._uniforms.push(e),this.locals.defineBoolean(e.toUpperCase()))},t.prototype.checkSampler=function(e){this._samplers.indexOf(e)===-1&&(this._samplers.push(e),this.locals.defineBoolean(e.toUpperCase()),this.checkUniform(e+"Infos"),this.checkUniform(e+"Matrix"))},t.prototype.getAnimatables=function(){var e=n.prototype.getAnimatables.call(this);for(var t in this._textures){var a=this._textures[t];a&&a.animations&&a.animations.length>0&&e.push(a)}return e},t.prototype.getActiveTextures=function(){var e=n.prototype.getActiveTextures.call(this);for(var t in this._textures){var a=this._textures[t];a&&e.push(a)}return e},t.prototype.hasTexture=function(e){if(n.prototype.hasTexture.call(this,e))return!0;var t=!1;for(var a in this._textures){var r=this._textures[a];if(r===r){t=!0;break}}return t},t.prototype.dispose=function(e,t){if(t)for(var a in this._textures){var r=this._textures[a];r&&r.dispose(),this._textures[a]=null}this._textures={},n.prototype.dispose.call(this,e,t)},t.prototype.clone=function(n){var t,a=this,r=e.SerializationHelper.Clone(function(){return new e.UniversalDiffuseMaterial(n,a.getScene())},this);r._textures={};for(t in this._textures){var i=this._textures[t];i&&r.setTexture(t,i.clone(),!0)}r._vectors4={};for(t in this._vectors4)r.setVector4(t,this._vectors4[t].clone(),!0);r._floats={};for(t in this._floats)r.setFloat(t,this._floats[t],!0);return r},t.prototype.serialize=function(){var n,t=e.SerializationHelper.Serialize(this);t.customType="BABYLON.UniversalDiffuseMaterial",t.textures={};for(n in this._textures){var a=this._textures[n];a&&(t.textures[n]=a.serialize())}t.vectors4={};for(n in this._vectors4)t.vectors4[n]=this._vectors4[n].asArray();t.floats={};for(n in this._floats)t.floats[n]=this._floats[n];return t},t.Parse=function(n,t,a){var r,i=e.SerializationHelper.Parse(function(){return new e.UniversalDiffuseMaterial(n.name,t)},n,t,a);for(r in n.textures){var o=n.textures[r];o&&i.setTexture(r,e.Texture.Parse(o,t,a),!0)}for(r in n.vectors4)i.setVector4(r,e.Vector4.FromArray(n.vectors4[r]),!0);for(r in n.floats)i.setFloat(r,n.floats[r],!0);return i},t.prototype.customShaderChunkResolve=function(){var n=this.getShaderChunk();if(null!=n&&""!==n){var t=n+"ShaderChunks";if(null!=e.Effect.ShadersStore[t]){this._enableShaderChunks=!0;var a=e.Effect.ShadersStore[t],r=e.Utilities.HasOwnProperty(a,"VertexBegin")?a.VertexBegin:null;null!=r&&""!==r&&(this._materialShaderChunks.Vertex_Begin=r);var i=e.Utilities.HasOwnProperty(a,"VertexDefinitions")?a.VertexDefinitions:null;null!=i&&""!==i&&(this._materialShaderChunks.Vertex_Definitions=i);var o=e.Utilities.HasOwnProperty(a,"VertexMainBegin")?a.VertexMainBegin:null;null!=o&&""!==o&&(this._materialShaderChunks.Vertex_MainBegin=o);var s=e.Utilities.HasOwnProperty(a,"VertexUpdatePosition")?a.VertexUpdatePosition:null;null!=s&&""!==s&&(this._materialShaderChunks.Vertex_Before_PositionUpdated=s.replace("result","positionUpdated"));var l=e.Utilities.HasOwnProperty(a,"VertexUpdateNormal")?a.VertexUpdateNormal:null;null!=l&&""!==l&&(this._materialShaderChunks.Vertex_Before_NormalUpdated=l.replace("result","normalUpdated"));var u=e.Utilities.HasOwnProperty(a,"VertexMainEnd")?a.VertexMainEnd:null;null!=u&&""!==u&&(this._materialShaderChunks.Vertex_MainEnd=u);var c=e.Utilities.HasOwnProperty(a,"FragmentBegin")?a.FragmentBegin:null;null!=c&&""!==c&&(this._materialShaderChunks.Fragment_Begin=c);var p=e.Utilities.HasOwnProperty(a,"FragmentDefinitions")?a.FragmentDefinitions:null;null!=p&&""!==p&&(this._materialShaderChunks.Fragment_Definitions=p);var d=e.Utilities.HasOwnProperty(a,"FragmentMainBegin")?a.FragmentMainBegin:null;null!=d&&""!==d&&(this._materialShaderChunks.Fragment_MainBegin=d);var g=e.Utilities.HasOwnProperty(a,"FragmentUpdateDiffuse")?a.FragmentUpdateDiffuse:null;null!=g&&""!==g&&(this._materialShaderChunks.Fragment_Custom_Diffuse=g.replace("result","diffuseColor"));var m=e.Utilities.HasOwnProperty(a,"FragmentUpdateAlpha")?a.FragmentUpdateAlpha:null;null!=m&&""!==m&&(this._materialShaderChunks.Fragment_Custom_Alpha=m.replace("result","alpha"));var h=e.Utilities.HasOwnProperty(a,"FragmentBeforeLights")?a.FragmentBeforeLights:null;null!=h&&""!==h&&(this._materialShaderChunks.Fragment_Before_Lights=h);var f=e.Utilities.HasOwnProperty(a,"FragmentBeforeFog")?a.FragmentBeforeFog:null;null!=f&&""!==f&&(this._materialShaderChunks.Fragment_Before_Fog=f);var S=e.Utilities.HasOwnProperty(a,"FragmentBeforeFragColor")?a.FragmentBeforeFragColor:null;null!=S&&""!==S&&(this._materialShaderChunks.Fragment_Before_FragColor=S.replace("result","color"))}else e.Tools.Warn("Failed To Locate Shader Chunk Base: "+t)}},t.prototype._buildCustomShader=function(e,n,t,a,r){this._defines=r;var i=this.getShaderName();null!=i&&""!==i||(i=e),null!=i&&""!==i||(i="default");var o=this.locals.getDefines();if(null!=o&&null!=this._defines){var s=Object.keys(o);if(null!=s&&s.length>0){for(var l=this._defines,u=0,c=s;u<c.length;u++){var p=c[u];l[p]=o[p]}this._defines.rebuild()}}var d=0;if(null!=this._uniforms&&this._uniforms.length>0)for(d=0;d<this._uniforms.length;d++){var g=this._uniforms[d];n.indexOf(g)===-1&&n.push(g)}if(d=0,null!=this._samplers&&this._samplers.length>0)for(d=0;d<this._samplers.length;d++){var m=this._samplers[d];a.indexOf(m)===-1&&a.push(m)}return this._enableShaderChunks===!0?this._createShaderChunks(i):i},t.prototype._createShaderChunks=function(n){if(this._isCreatedShader)return this._createdShaderName;this._isCreatedShader=!1;var t=this.getShaderChunk();null!=t&&""!==t||(t=n),e.UniversalShaderDefines.ShaderIndexer++;var a=(t+"Custom"+e.UniversalShaderDefines.ShaderIndexer).trim(),r=e.Effect.ShadersStore[n+"VertexShader"],i=e.Effect.ShadersStore[n+"PixelShader"],o=a+"VertexShader";e.Effect.ShadersStore[o]=r.replace("#define CUSTOM_VERTEX_BEGIN",this._materialShaderChunks.Vertex_Begin?this._materialShaderChunks.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",this._materialShaderChunks.Vertex_Definitions?this._materialShaderChunks.Vertex_Definitions:"").replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this._materialShaderChunks.Vertex_MainBegin?this._materialShaderChunks.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this._materialShaderChunks.Vertex_Before_PositionUpdated?this._materialShaderChunks.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this._materialShaderChunks.Vertex_Before_NormalUpdated?this._materialShaderChunks.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",this._materialShaderChunks.Vertex_MainEnd?this._materialShaderChunks.Vertex_MainEnd:"");var s=a+"PixelShader";return e.Effect.ShadersStore[s]=i.replace("#define CUSTOM_FRAGMENT_BEGIN",this._materialShaderChunks.Fragment_Begin?this._materialShaderChunks.Fragment_Begin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",this._materialShaderChunks.Fragment_Definitions?this._materialShaderChunks.Fragment_Definitions:"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this._materialShaderChunks.Fragment_MainBegin?this._materialShaderChunks.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE",this._materialShaderChunks.Fragment_Custom_Diffuse?this._materialShaderChunks.Fragment_Custom_Diffuse:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this._materialShaderChunks.Fragment_Custom_Alpha?this._materialShaderChunks.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this._materialShaderChunks.Fragment_Before_Lights?this._materialShaderChunks.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this._materialShaderChunks.Fragment_Before_Fog?this._materialShaderChunks.Fragment_Before_Fog:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this._materialShaderChunks.Fragment_Before_FragColor?this._materialShaderChunks.Fragment_Before_FragColor:""),this._isCreatedShader=!0,this._createdShaderName=a,a},t.prototype._attachAfterBind=function(e,n){var t,a=this.getScene();if(a.texturesEnabled)for(t in this._textures){var r=this._textures[t];null!=r&&(n.setTexture(t,r),n.setFloat2(t+"Infos",r.coordinatesIndex,r.level),n.setMatrix(t+"Matrix",r.getTextureMatrix()))}for(t in this._vectors4)n.setVector4(t,this._vectors4[t]);for(t in this._floats)n.setFloat(t,this._floats[t])},t.prototype._setupAttachAfterBind=function(){var e=this,n=this._afterBind;this._afterBind=function(t,a){if(e._attachAfterBind(t,a),n)try{n(t,a)}catch(r){}}},t}(e.StandardMaterial);e.UniversalDiffuseMaterial=l,e._TypeStore.RegisteredTypes.UniversalDiffuseMaterial=l}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var n;!function(e){e[e.Deg2Rad=.0174532924]="Deg2Rad",e[e.Rad2Deg=57.29578]="Rad2Deg"}(n=e.System||(e.System={}));var t;!function(e){e[e.Default=-1]="Default",e[e.Right=0]="Right",e[e.Left=1]="Left"}(t=e.Handedness||(e.Handedness={}));var a;!function(e){e[e.ExactMatch=0]="ExactMatch",e[e.StartsWith=1]="StartsWith",e[e.EndsWith=2]="EndsWith",e[e.IndexOf=3]="IndexOf"}(a=e.SearchType||(e.SearchType={}));var r;!function(e){e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four"}(r=e.PlayerNumber||(e.PlayerNumber={}));var i;!function(e){e[e.None=-1]="None",e[e.Generic=0]="Generic",e[e.Xbox360=1]="Xbox360"}(i=e.GamepadType||(e.GamepadType={}));var o;!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(o=e.JoystickButton||(e.JoystickButton={}));var s;!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(s=e.Xbox360Trigger||(e.Xbox360Trigger={}));var l;!function(e){e[e.DirectVelocity=0]="DirectVelocity",e[e.AppliedForces=1]="AppliedForces",e[e.CheckCollision=2]="CheckCollision"}(l=e.MovementType||(e.MovementType={}));var u;!function(e){e[e.Top=0]="Top",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom"}(u=e.CollisionContact||(e.CollisionContact={}));var c;!function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"}(c=e.UserInputPointer||(e.UserInputPointer={}));var p;!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.ClientX=2]="ClientX",e[e.ClientY=3]="ClientY",e[e.MouseX=4]="MouseX",e[e.MouseY=5]="MouseY",e[e.Wheel=6]="Wheel"}(p=e.UserInputAxis||(e.UserInputAxis={}));var d;!function(e){e[e.CF_STATIC_OBJECT=1]="CF_STATIC_OBJECT",e[e.CF_KINEMATIC_OBJECT=2]="CF_KINEMATIC_OBJECT",e[e.CF_NO_CONTACT_RESPONSE=4]="CF_NO_CONTACT_RESPONSE",e[e.CF_CUSTOM_MATERIAL_CALLBACK=8]="CF_CUSTOM_MATERIAL_CALLBACK",e[e.CF_CHARACTER_OBJECT=16]="CF_CHARACTER_OBJECT",e[e.CF_DISABLE_VISUALIZE_OBJECT=32]="CF_DISABLE_VISUALIZE_OBJECT",e[e.CF_DISABLE_SPU_COLLISION_PROCESSING=64]="CF_DISABLE_SPU_COLLISION_PROCESSING",e[e.CF_HAS_CONTACT_STIFFNESS_DAMPING=128]="CF_HAS_CONTACT_STIFFNESS_DAMPING",e[e.CF_HAS_CUSTOM_DEBUG_RENDERING_COLOR=256]="CF_HAS_CUSTOM_DEBUG_RENDERING_COLOR",e[e.CF_HAS_FRICTION_ANCHOR=512]="CF_HAS_FRICTION_ANCHOR",e[e.CF_HAS_COLLISION_SOUND_TRIGGER=1024]="CF_HAS_COLLISION_SOUND_TRIGGER"}(d=e.CollisionFlags||(e.CollisionFlags={}));var g;!function(e){e[e.BackSpace=8]="BackSpace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Pause=19]="Pause",e[e.Break=19]="Break",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.SpaceBar=32]="SpaceBar",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.Numpad0=96]="Numpad0",e[e.Numpad1=97]="Numpad1",e[e.Numpad2=98]="Numpad2",e[e.Numpad3=99]="Numpad3",e[e.Numpad4=100]="Numpad4",e[e.Numpad5=101]="Numpad5",e[e.Numpad6=102]="Numpad6",e[e.Numpad7=103]="Numpad7",e[e.Numpad8=104]="Numpad8",e[e.Numpad9=105]="Numpad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.EqualSign=187]="EqualSign",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBraket=221]="CloseBraket",e[e.SingleQuote=222]="SingleQuote"}(g=e.UserInputKey||(e.UserInputKey={}));var m=function(){function e(){}return e.JoystickRightHandleColor="yellow",e.JoystickLeftSensibility=1,e.JoystickRightSensibility=1,e.JoystickDeadStickValue=.1,e.GamepadDeadStickValue=.25,e.GamepadLStickXInverted=!1,e.GamepadLStickYInverted=!1,e.GamepadRStickXInverted=!1,e.GamepadRStickYInverted=!1,e.GamepadLStickSensibility=1,e.GamepadRStickSensibility=1,e.PointerAngularSensibility=1,e.PointerWheelDeadZone=.1,e}();e.UserInputOptions=m;var h=function(){function n(){}return n.Angle=function(n,t){return 57.29578*Math.acos(e.Scalar.Clamp(e.Vector3.Dot(n.normalize(),t.normalize()),-1,1))},n.ClampAngle=function(n,t,a){var r=n;do r<-360&&(r+=360),r>360&&(r-=360);while(r<-360||r>360);return e.Scalar.Clamp(r,t,a)},n.Deg2Rad=function(n){return n*e.System.Deg2Rad},n.Rad2Deg=function(n){return n*e.System.Rad2Deg},n.Euler=function(n,t,a){return e.Quaternion.RotationYawPitchRoll(t,n,a)},n.EulerToRef=function(n,t,a,r){e.Quaternion.RotationYawPitchRollToRef(t,n,a,r)},n.Matrix=function(n,t,a){return e.Matrix.RotationYawPitchRoll(t,n,a)},n.MatrixToRef=function(n,t,a,r){e.Matrix.RotationYawPitchRollToRef(t,n,a,r)},n.RotateVector=function(n,t){var a=2*(t.y*n.z-t.z*n.y),r=2*(t.z*n.x-t.x*n.z),i=2*(t.x*n.y-t.y*n.x);return new e.Vector3(n.x+t.w*a+(t.y*i-t.z*r),n.y+t.w*r+(t.z*a-t.x*i),n.z+t.w*i+(t.x*r-t.y*a))},n.RotateVectorToRef=function(e,n,t){var a=2*(n.y*e.z-n.z*e.y),r=2*(n.z*e.x-n.x*e.z),i=2*(n.x*e.y-n.y*e.x);t.x=e.x+n.w*a+(n.y*i-n.z*r),t.y=e.y+n.w*r+(n.z*a-n.x*i),t.z=e.z+n.w*i+(n.x*r-n.y*a)},n.LookRotation=function(n){var t=e.Quaternion.Zero();return e.Utilities.LookRotationToRef(n,t),t},n.LookRotationToRef=function(n,t){e.Utilities.TempMatrix.reset(),e.Matrix.LookAtLHToRef(e.Utilities.ZeroVector,n,e.Utilities.UpVector,e.Utilities.TempMatrix),e.Utilities.TempMatrix.invert(),e.Quaternion.FromRotationMatrixToRef(e.Utilities.TempMatrix,t)},n.DownloadEnvironment=function(n,t,a){void 0===t&&(t=null),void 0===a&&(a=null),e.EnvironmentTextureTools.CreateEnvTextureAsync(n).then(function(a){var r=n.name||"Environment",i=new Blob([a],{type:"octet/stream"});e.Tools.Download(i,r+".env"),null!=t&&t()})["catch"](function(e){console.error(e),null!=a&&a()})},n.HasOwnProperty=function(e,n){return null!=e&&null!=n&&""!==n&&n in e},n.GetFilenameFromUrl=function(e){return e.substring(e.lastIndexOf("/")+1)},n.PrintToScreen=function(n,t){if(void 0===t&&(t="white"),e.Utilities.PrintElement=document.getElementById("print"),null==e.Utilities.PrintElement){var a=document.createElement("div");a.id="print",a.style.position="absolute",a.style.left="6px",a.style.bottom="3px",a.style.fontSize="12px",a.style.zIndex="10000",a.style.color="#0c0",document.body.appendChild(a),e.Utilities.PrintElement=a}null!=e.Utilities.PrintElement&&e.Utilities.PrintElement.innerHTML!==n&&(e.Utilities.PrintElement.style.color!==t&&(e.Utilities.PrintElement.style.color=t),e.Utilities.PrintElement.innerHTML=n)},n.StartsWith=function(e,n){return 0===e.lastIndexOf(n,0)},n.EndsWith=function(e,n){return e.indexOf(n,e.length-n.length)!==-1},n.ReplaceAll=function(e,n,t){return e.replace(new RegExp(n,"g"),t)},n.IsNullOrEmpty=function(e){return null==e||""===e},n.SafeStringPush=function(e,n){e.indexOf(n)===-1&&e.push(n)},n.ParseColor3=function(n,t){void 0===t&&(t=null);var a=null;return a=null!=n&&null!=n.r&&null!=n.g&&null!=n.b?new e.Color3(n.r,n.g,n.b):t},n.ParseColor4=function(n,t){void 0===t&&(t=null);var a=null;if(null!=n&&null!=n.r&&null!=n.g&&null!=n.b){null!=n.a?n.a:1;a=new e.Color4(n.r,n.g,n.b,n.a)}else a=t;return a},n.ParseVector2=function(n,t){void 0===t&&(t=null);var a=null;return a=null!=n&&null!=n.x&&null!=n.y?new e.Vector2(n.x,n.y):t},n.ParseVector3=function(n,t){void 0===t&&(t=null);var a=null;return a=null!=n&&null!=n.x&&null!=n.y&&null!=n.z?new e.Vector3(n.x,n.y,n.z):t},n.ParseVector4=function(n,t){void 0===t&&(t=null);var a=null;return a=null!=n&&null!=n.x&&null!=n.y&&null!=n.z&&null!=n.w?new e.Vector4(n.x,n.y,n.z,n.w):t},n.TransformPosition=function(n,t){return e.Vector3.TransformCoordinates(t,n.getWorldMatrix())},n.TransformPositionToRef=function(n,t,a){return e.Vector3.TransformCoordinatesToRef(t,n.getWorldMatrix(),a)},n.TransformDirection=function(n,t){return e.Vector3.TransformNormal(t,n.getWorldMatrix())},n.TransformDirectionToRef=function(n,t,a){return e.Vector3.TransformNormalToRef(t,n.getWorldMatrix(),a)},n.RecomputePivotPoint=function(n){var t=n.getBoundingInfo().boundingSphere.center;n.setPivotMatrix(e.Matrix.Translation(-t.x,-t.y,-t.z))},n.GetDirectionVector=function(e,n){return e.getDirection(n)},n.GetDirectionVectorToRef=function(e,n,t){e.getDirectionToRef(n,t)},n.GetForwardVector=function(n){return n.getDirection(e.Vector3.Forward())},n.GetForwardVectorToRef=function(n,t){n.getDirectionToRef(e.Vector3.Forward(),t)},n.GetRightVector=function(n){return n.getDirection(e.Vector3.Right())},n.GetRightVectorToRef=function(n,t){n.getDirectionToRef(e.Vector3.Right(),t)},n.GetUpVector=function(n){return n.getDirection(e.Vector3.Up())},n.GetUpVectorToRef=function(n,t){n.getDirectionToRef(e.Vector3.Up(),t)},n.SampleAnimationMatrix=function(n,t,a,r){if(null!=n&&n.dataType===e.Animation.ANIMATIONTYPE_MATRIX){var i=n.getKeys();t<i[0].frame?t=i[0].frame:t>i[i.length-1].frame&&(t=i[i.length-1].frame),e.Utilities.FastMatrixInterpolate(n,t,a,r)}},n.SampleAnimationFloat=function(n,t,a,r,i,o){void 0===i&&(i=null),void 0===o&&(o=null);var s=0;if(null!=n&&n.dataType===e.Animation.ANIMATIONTYPE_FLOAT){var l=n.getKeys();t<l[0].frame?t=l[0].frame:t>l[l.length-1].frame&&(t=l[l.length-1].frame),s=e.Utilities.FastFloatInterpolate(n,t,a,r,i,o)}return s},n.FastMatrixLerp=function(n,t,a,r){e.Matrix.LerpToRef(n,t,a,r)},n.FastMatrixSlerp=function(n,t,a,r){e.Matrix.DecomposeLerpToRef(n,t,a,r)},n.FastMatrixInterpolate=function(n,t,a,r){var i=n.getKeys(),o=Math.max(0,Math.min(i.length-1,Math.floor(i.length*(t-i[0].frame)/(i[i.length-1].frame-i[0].frame))-1));if(i[o].frame>=t)for(;o-1>=0&&i[o].frame>=t;)o--;for(var s=o;s<i.length;s++){var l=i[s+1];if(l.frame>=t){var u=i[s],c=u.value;if(u.interpolation===e.AnimationKeyInterpolation.STEP)return void r.copyFrom(c);var p=l.value,d=(void 0!==u.outTangent&&void 0!==l.inTangent,l.frame-u.frame),g=(t-u.frame)/d,m=n.getEasingFunction();switch(null!=m&&(g=m.ease(g)),a){case e.Animation.ANIMATIONLOOPMODE_CYCLE:case e.Animation.ANIMATIONLOOPMODE_CONSTANT:return void e.Utilities.FastMatrixSlerp(c,p,g,r);case e.Animation.ANIMATIONLOOPMODE_RELATIVE:return void r.copyFrom(c)}break}}r.copyFrom(i[i.length-1].value)},n.FastFloatInterpolate=function(n,t,a,r,i,o){if(void 0===i&&(i=null),void 0===o&&(o=null),r===e.Animation.ANIMATIONLOOPMODE_CONSTANT&&a>0)return o.clone?o.clone():o;var s=n.getKeys(),l=Math.max(0,Math.min(s.length-1,Math.floor(s.length*(t-s[0].frame)/(s[s.length-1].frame-s[0].frame))-1));if(s[l].frame>=t)for(;l-1>=0&&s[l].frame>=t;)l--;for(var u=l;u<s.length;u++){var c=s[u+1];if(c.frame>=t){var p=s[u],d=p.value;if(p.interpolation===e.AnimationKeyInterpolation.STEP)return d;var g=c.value,m=void 0!==p.outTangent&&void 0!==c.inTangent,h=c.frame-p.frame,f=(t-p.frame)/h,S=n.getEasingFunction();null!=S&&(f=S.ease(f));var y=m?n.floatInterpolateFunctionWithTangents(d,p.outTangent*h,g,c.inTangent*h,f):n.floatInterpolateFunction(d,g,f);switch(r){case e.Animation.ANIMATIONLOOPMODE_CYCLE:case e.Animation.ANIMATIONLOOPMODE_CONSTANT:return y;case e.Animation.ANIMATIONLOOPMODE_RELATIVE:return i*a+y}break}}return s[s.length-1].value},n.FormatPhysicsImposterType=function(n){var t="Unknownr";switch(n){case e.PhysicsImpostor.NoImpostor:t="No";break;case e.PhysicsImpostor.SphereImpostor:t="Sphere";break;case e.PhysicsImpostor.BoxImpostor:t="Box";break;case e.PhysicsImpostor.PlaneImpostor:t="Plane";break;case e.PhysicsImpostor.MeshImpostor:t="Mesh";break;case e.PhysicsImpostor.CylinderImpostor:t="Cylinder";break;case e.PhysicsImpostor.ParticleImpostor:t="Particle";break;case e.PhysicsImpostor.HeightmapImpostor:t="Heightmap";break;case e.PhysicsImpostor.ConvexHullImpostor:t="ConvexHull"}return t},n.SetAnimationLooping=function(e,n){if(null!=e&&null!=e.animations&&e.animations.length>0)for(var t=e.animations,a=0;a<t.length;a++)t[a].loopMode=n},n.SetSkeletonLooping=function(n,t){null!=n&&(null==n.animationPropertiesOverride&&(n.animationPropertiesOverride=new e.AnimationPropertiesOverride),n.animationPropertiesOverride.loopMode=t)},n.SetSkeletonBlending=function(n,t){null!=n&&(null==n.animationPropertiesOverride&&(n.animationPropertiesOverride=new e.AnimationPropertiesOverride),n.animationPropertiesOverride.enableBlending=t>0,n.animationPropertiesOverride.blendingSpeed=t)},n.SetSkeletonProperties=function(n,t,a){null!=n&&(null==n.animationPropertiesOverride&&(n.animationPropertiesOverride=new e.AnimationPropertiesOverride),n.animationPropertiesOverride.loopMode=t,n.animationPropertiesOverride.enableBlending=a>0,n.animationPropertiesOverride.blendingSpeed=a)},n.ComputeBlendingSpeed=function(e,n){return 1/(e*n)},n.CalculateCameraDistance=function(e,n,t){void 0===t&&(t=1);var a=1;return Math.round(e*t*n*a)},n.InstantiateClass=function(e){for(var n=e.split("."),t=window||this,a=0,r=n.length;a<r;a++)t=t[n[a]];return"function"==typeof t?t:null},n.DisposeEntity=function(n){if(null!=n){if(null!=n.metadata&&n.metadata.unity){var t=n.metadata.unity;null!=t.components&&t.components.length>0&&t.components.forEach(function(n){null!=n.instance&&(e.SceneManager.DestroyScriptComponent(n.instance),n.instance=null)}),delete n.metadata.unity,null!=n.metadata.clone&&delete n.metadata.clone}if(null!=n.physicsImpostor){var a=n.physicsImpostor;null!=a.onCollideEvent&&(a.onCollideEvent=null),n.physicsImpostor.dispose(),n.physicsImpostor=null}null!=n.skeleton&&null!=n.skeleton.bones&&n.skeleton.bones.length>0&&n.skeleton.bones.forEach(function(e){null!=e&&null!=e.metadata&&(e.metadata=null)}),null!=n.cameraRig&&(n.cameraRig.dispose&&n.cameraRig.dispose(),delete n.cameraRig),null!=n.lightRig&&(n.lightRig.dispose&&n.lightRig.dispose(),delete n.lightRig),null!=n.flareRig&&(n.flareRig.dispose&&n.flareRig.dispose(),delete n.flareRig)}},n.FindMesh=function(n,t,a){void 0===a&&(a=e.SearchType.StartsWith);var r=null,i=null!=a?a:e.SearchType.StartsWith;if(null!=t&&t.length>0)for(var o=0;o<t.length;o++){var s=t[o];if(i===e.SearchType.StartsWith){if(e.Utilities.StartsWith(s.name,n)){r=s;break}}else if(i===e.SearchType.EndsWith){if(e.Utilities.EndsWith(s.name,n)){r=s;break}}else if(i===e.SearchType.IndexOf){if(s.name.indexOf(n)>=0){r=s;break}}else if(s.name===n){r=s;break}}return r},n.CreateGuid=function(n){void 0===n&&(n=null);var t=e.Tools.RandomId();return e.Utilities.IsNullOrEmpty(t)||(t+="_"+n),t},n.ValidateTransformGuid=function(e){if(null!=e&&null!=e.metadata&&null!=e.metadata.unity&&null!=e.metadata.unity.guid&&""!==e.metadata.unity.guid){var n=e.metadata.unity.guid;e.id!==n&&(e.id=n),delete e.metadata.unity.guid}},n.CloneValue=function(n,t){return n?n instanceof e.Mesh?null:n instanceof e.SubMesh?n.clone(t):n.clone?n.clone():n:null},n.CloneMetadata=function(n){var t=null;if(null!=n){var a=null;if(null!=n.unity){var r=null==n.unity.visible||n.unity.visible,i=null!=n.unity.visibility?n.unity.visibility:1,o=null!=n.unity.billboard?n.unity.billboard:0,s=null!=n.unity.tags?n.unity.tags:"Untagged Layer0",l=null!=n.unity.skin&&n.unity.skin,u=null!=n.unity.bone?n.unity.bone:null,c=null!=n.unity.group?n.unity.group:"Untagged",p=null!=n.unity.layer?n.unity.layer:0,d=null!=n.unity.layername?n.unity.layername:"Default",g=null,m=null,h=null,f=null;n.unity.physics&&(g={},e.Utilities.DeepCopyProperties(n.unity.physics,g)),n.unity.renderer&&(m={},e.Utilities.DeepCopyProperties(n.unity.renderer,m)),n.unity.collision&&(h={},e.Utilities.DeepCopyProperties(n.unity.collision,h)),n.unity.properties&&(f={},e.Utilities.DeepCopyProperties(n.unity.properties,f));var S=null;null!=n.unity.components&&n.unity.components.length>0&&(S=[],n.unity.components.forEach(function(n){if(null!=n){var t={},a=null!=n.alias&&"script"===n.alias;e.Utilities.DeepCopyProperties(n,t,["instance"]),a===!0&&(t.instance=null),S.push(t)}})),a={},a.parsed=!1,a.prefab=!1,a.lods=null,a.coverages=null,a.distances=null,a.visible=r,a.visibility=i,a.billboard=o,a.tags=s,a.skin=l,a.bone=u,a.group=c,a.layer=p,a.layername=d,a.renderer=m,a.physics=g,a.collision=h,a.properties=f,a.components=S}null!=a&&(t={unity:a})}return t},n.DeepCopyProperties=function(n,t,a,r){for(var i in n)if(("_"!==i[0]||r&&r.indexOf(i)!==-1)&&(!a||a.indexOf(i)===-1)){var o=n[i],s=typeof o;if("function"!==s)if("object"===s)if(o instanceof Array){if(t[i]=[],o.length>0)if("object"==typeof o[0])for(var l=0;l<o.length;l++){var u=e.Utilities.CloneValue(o[l],t);t[i].indexOf(u)===-1&&t[i].push(u)}else t[i]=o.slice(0)}else t[i]=e.Utilities.CloneValue(o,t);else t[i]=o}},n.ValidateTransformMetadata=function(n){null==n.metadata&&(n.metadata={}),null==n.metadata.unity&&(n.metadata.unity={});var t=n.metadata.unity;e.Utilities.HasOwnProperty(t,"parsed")||(n.metadata.unity.parsed=!1),e.Utilities.HasOwnProperty(t,"prefab")||(n.metadata.unity.prefab=!1),e.Utilities.HasOwnProperty(t,"visible")||(n.metadata.unity.visible=!0),e.Utilities.HasOwnProperty(t,"visibility")||(n.metadata.unity.visibility=1),e.Utilities.HasOwnProperty(t,"billboard")||(n.metadata.unity.billboard=0),e.Utilities.HasOwnProperty(t,"tags")||(n.metadata.unity.tags="Untagged Layer0"),e.Utilities.HasOwnProperty(t,"skin")||(n.metadata.unity.skin=!1),e.Utilities.HasOwnProperty(t,"bone")||(n.metadata.unity.bone=null),e.Utilities.HasOwnProperty(t,"group")||(n.metadata.unity.group="Untagged"),e.Utilities.HasOwnProperty(t,"layer")||(n.metadata.unity.layer=0),e.Utilities.HasOwnProperty(t,"layername")||(n.metadata.unity.layername="Default"),e.Utilities.HasOwnProperty(t,"lods")||(n.metadata.unity.lods=null),e.Utilities.HasOwnProperty(t,"coverages")||(n.metadata.unity.coverages=null),e.Utilities.HasOwnProperty(t,"distances")||(n.metadata.unity.distances=null),e.Utilities.HasOwnProperty(t,"physics")||(n.metadata.unity.physics=null),e.Utilities.HasOwnProperty(t,"renderer")||(n.metadata.unity.renderer=null),e.Utilities.HasOwnProperty(t,"collision")||(n.metadata.unity.collision=null),e.Utilities.HasOwnProperty(t,"properties")||(n.metadata.unity.properties=null),e.Utilities.HasOwnProperty(t,"components")||(n.metadata.unity.components=null)},n.UpVector=e.Vector3.Up(),n.ZeroVector=e.Vector3.Zero(),n.TempMatrix=e.Matrix.Zero(),n.TempVector2=e.Vector2.Zero(),n.TempVector3=e.Vector3.Zero(),n.PrintElement=null,n}();e.Utilities=h}(BABYLON||(BABYLON={}));var TimerPlugin=window;TimerPlugin.requestAnimFrame=function(){return TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame||function(e,n){window.setTimeout(e,1e3/60)}}(),TimerPlugin.requestInterval=function(e,n){function t(){var i=TimerPlugin.getTimeMilliseconds(),o=i-a;o>=n&&(e.call(),a=TimerPlugin.getTimeMilliseconds()),r.value=TimerPlugin.requestAnimFrame(t)}if(!(TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame&&TimerPlugin.mozCancelRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame))return window.setInterval(e,n);var a=TimerPlugin.getTimeMilliseconds(),r=new Object;return r.value=TimerPlugin.requestAnimFrame(t),
r},TimerPlugin.clearRequestInterval=function(e){TimerPlugin.cancelAnimationFrame?TimerPlugin.cancelAnimationFrame(e.value):TimerPlugin.webkitCancelAnimationFrame?TimerPlugin.webkitCancelAnimationFrame(e.value):TimerPlugin.webkitCancelRequestAnimationFrame?TimerPlugin.webkitCancelRequestAnimationFrame(e.value):TimerPlugin.mozCancelRequestAnimationFrame?TimerPlugin.mozCancelRequestAnimationFrame(e.value):TimerPlugin.oCancelRequestAnimationFrame?TimerPlugin.oCancelRequestAnimationFrame(e.value):TimerPlugin.msCancelRequestAnimationFrame?TimerPlugin.msCancelRequestAnimationFrame(e.value):window.clearInterval(e),e=null},TimerPlugin.requestTimeout=function(e,n){function t(){var i=TimerPlugin.getTimeMilliseconds(),o=i-a;o>=n?e.call():r.value=TimerPlugin.requestAnimFrame(t)}if(!(TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame&&TimerPlugin.mozCancelRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame))return window.setTimeout(e,n);var a=TimerPlugin.getTimeMilliseconds(),r=new Object;return r.value=TimerPlugin.requestAnimFrame(t),r},TimerPlugin.clearRequestTimeout=function(e){TimerPlugin.cancelAnimationFrame?TimerPlugin.cancelAnimationFrame(e.value):TimerPlugin.webkitCancelAnimationFrame?TimerPlugin.webkitCancelAnimationFrame(e.value):TimerPlugin.webkitCancelRequestAnimationFrame?TimerPlugin.webkitCancelRequestAnimationFrame(e.value):TimerPlugin.mozCancelRequestAnimationFrame?TimerPlugin.mozCancelRequestAnimationFrame(e.value):TimerPlugin.oCancelRequestAnimationFrame?TimerPlugin.oCancelRequestAnimationFrame(e.value):TimerPlugin.msCancelRequestAnimationFrame?TimerPlugin.msCancelRequestAnimationFrame(e.value):window.clearTimeout(e),e=null},TimerPlugin.getTimeMilliseconds=function(){return(performance||Date).now()};var CVTOOLS_NAME="CVTOOLS_unity_metadata",CVTOOLS_MESH="CVTOOLS_babylon_mesh",CVTOOLS_HAND="CVTOOLS_left_handed",CVTOOLS_unity_metadata=function(){function e(e){this.name=CVTOOLS_NAME,this.enabled=!0,this._parseScene=!1,this._leftHanded=!1,this._disposeRoot=!1,this._sceneParsed=!1,this._rootUrl=null,this._loader=e,this._parser=new BABYLON.MetadataParser(this._loader.babylonScene,this._loader),this._parseScene=this._leftHanded=this._disposeRoot=this._sceneParsed=!1}return e.prototype.dispose=function(){delete this._loader,this._parser=this._rootUrl=null,this._parseScene=this._leftHanded=this._disposeRoot=this._sceneParsed=!1},e.prototype.onLoading=function(){this._rootUrl=this._loader._uniqueRootUrl?this._loader._uniqueRootUrl:"",this._parseScene=BABYLON.SceneManager.IsSceneLoaderEnabled()===!0&&null!=this._loader.gltf&&null!=this._loader.gltf.extensionsUsed&&this._loader.gltf.extensionsUsed.indexOf(CVTOOLS_NAME)>=0,this._leftHanded=null!=this._loader.gltf&&null!=this._loader.gltf.extensionsUsed&&this._loader.gltf.extensionsUsed.indexOf(CVTOOLS_HAND)>=0,this._disposeRoot=this._sceneParsed=!1,this._parseScene===!0,this._leftHanded===!0&&null!=this._loader.rootBabylonMesh&&(this._loader.rootBabylonMesh.rotationQuaternion=BABYLON.Quaternion.Identity(),this._loader.rootBabylonMesh.scaling=BABYLON.Vector3.One())},e.prototype.onReady=function(){this._parseScene===!0&&(this._disposeRoot===!0&&null!=this._loader.rootBabylonMesh&&this._loader.rootBabylonMesh.dispose(!0),this._parser.postProcessSceneComponents())},e.prototype.loadSceneAsync=function(e,n){return this._parseScene===!0&&null!=n.extras&&null!=n.extras.metadata?(this._parseSceneProperties(e,n),this._loader.loadSceneAsync(e,n)):null},e.prototype.loadNodeAsync=function(e,n,t){var a=this;return this._parseScene===!0&&null!=n.extras&&null!=n.extras.metadata?this._loader.loadNodeAsync(e,n,function(e){var r=e,i=n.extras.metadata;if(null==r.metadata&&(r.metadata={}),r.metadata.unity=i,BABYLON.Utilities.ValidateTransformGuid(r),BABYLON.Utilities.ValidateTransformMetadata(r),r.name.indexOf("_dispose")>=0)a._parser.addDisposeEntityItem(r);else{var o=null!=r.metadata.unity.prefab&&r.metadata.unity.prefab;r.isVisible=null==r.metadata.unity.visible||r.metadata.unity.visible,r.visibility=null!=r.metadata.unity.visibility?r.metadata.unity.visibility:1,r.billboardMode=null!=r.metadata.unity.billboard?r.metadata.unity.billboard:0,o===!0?(r.setEnabled(!1),r.metadata.clone=function(){return BABYLON.Utilities.CloneMetadata(r.metadata)}):a._parser.parseSceneComponents(r)}t(r)}):null},e.prototype.loadMaterialPropertiesAsync=function(e,n,t){return this._leftHanded===!0&&(t.sideOrientation=BABYLON.Material.CounterClockWiseSideOrientation),this._parseScene===!0?t instanceof BABYLON.ShaderMaterial?this._parseShaderMaterialPropertiesAsync(e,n,t):t instanceof BABYLON.PBRMaterial?this._parseAlbedoMaterialPropertiesAsync(e,n,t):this._parseDiffuseMaterialPropertiesAsync(e,n,t):null},e.prototype.createMaterial=function(e,n,t){if(this._parseScene===!0&&null!=n.extras&&null!=n.extras.metadata&&null!=n.extras.metadata.customMaterial){var a=null,r=n.name||"No Name",i=n.extras.metadata,o=i.customMaterial,s=BABYLON.Utilities.InstantiateClass(o);if(null!=s){var l=new s(r,this._loader.babylonScene);if(null!=l){var u=l instanceof BABYLON.Material;u===!0?(a=l,a.fillMode=t,a.sideOrientation=this._loader.babylonScene.useRightHandedSystem?BABYLON.Material.CounterClockWiseSideOrientation:BABYLON.Material.ClockWiseSideOrientation,a instanceof BABYLON.ShaderMaterial&&BABYLON.UniversalShaderMaterial.Initialize(a)):BABYLON.Tools.Warn("Non material instantiated class: "+o)}else BABYLON.Tools.Warn("Failed to instantiate material class: "+o)}else BABYLON.Tools.Warn("Failed to locate material class: "+o);return a}return null},e.prototype._loadMeshPrimitiveAsync=function(e,n,t,a,r,i){var o=this;if(this._parseScene===!0){var s=this._loader;s.logOpen(""+e);var l,u=void 0==t.skin&&!a.primitives[0].targets,c=void 0,p=r._instanceData;if(u&&p)l=p.babylonSourceMesh.createInstance(n),c=p.promise;else{var d=new Array,g=new BABYLON.Mesh(n,s._babylonScene);s._createMorphTargets(e,t,a,r,g),d.push(s._loadVertexDataAsync(e,r,g).then(function(n){return s._loadMorphTargetsAsync(e,r,g,n).then(function(){n.applyToMesh(g),o._setupBabylonMesh(g,t,a,r)})}));var m=BABYLON.GLTF2.GLTFLoader._GetDrawMode(e,r.mode);if(null!=r.extras&&null!=r.extras.metadata&&null!=r.extras.metadata.multimaterial&&null!=r.extras.metadata.submeshes)this._setupBabylonMaterials(e,d,m,g,a,r);else if(void 0==r.material){var h=s._defaultBabylonMaterialData[m];h||(h=s._createDefaultMaterial("__GLTFLoader._default",m),s._parent.onMaterialLoadedObservable.notifyObservers(h),s._defaultBabylonMaterialData[m]=h),g.material=h}else{var f=BABYLON.GLTF2.ArrayItem.Get(e+"/material",s._gltf.materials,r.material);d.push(s._loadMaterialAsync("/materials/"+f.index,f,g,m,function(e){g.material=e}))}c=Promise.all(d),u&&(r._instanceData={babylonSourceMesh:g,promise:c}),l=g}return BABYLON.GLTF2.GLTFLoader.AddPointerMetadata(l,e),s._parent.onMeshLoadedObservable.notifyObservers(l),i(l),s.logClose(),c.then(function(){return l})}return null},e.prototype._setupBabylonMesh=function(e,n,t,a){if(this._parseScene===!0){this._loader;if(null!=a.extras&&null!=a.extras.metadata&&null!=a.extras.metadata.multimaterial&&null!=a.extras.metadata.submeshes){var r=a.extras.metadata.submeshes;e.subMeshes=[];for(var i=0;i<r.length;i++){var o=r[i];BABYLON.SubMesh.AddToMesh(o.materialIndex,o.verticesStart,o.verticesCount,o.indexStart,o.indexCount,e)}}null!=n.extras&&null!=n.extras.metadata&&null!=n.extras.metadata.lods&&null!=n.extras.metadata.distances&&this._parser.addDetailLevelItem(e),e.computeWorldMatrix(!0)}},e.prototype._setupBabylonMaterials=function(e,n,t,a,r,i){if(this._parseScene===!0){var o=this._loader,s=i.extras.metadata.multimaterial,l=s.materials,u=[],c=s.id||r.name+"_multi",p=s.name||r.name+"_multi",d=new BABYLON.MultiMaterial(p,o._babylonScene);d.id=c,l.forEach(function(n){var t=BABYLON.GLTF2.ArrayItem.Get(e+"/material",o._gltf.materials,parseInt(n));u.push(t)}),n.push(this._parseMultiMaterialAsync("/materials/"+p,u,a,t,function(e){d.subMaterials=e,a.material=d}))}},e.prototype._parseSceneProperties=function(e,n){if(this._sceneParsed===!1&&null!=n.extras&&null!=n.extras.metadata&&null!=n.extras.metadata.properties&&n.extras.metadata.properties===!0){this._sceneParsed=!0;var t=n.extras.metadata,a=this._loader._fileName?this._loader._fileName:null;if(null!=this._loader.rootBabylonMesh&&(this._loader.rootBabylonMesh.name="Root."+a.replace(".gltf","").replace(".glb","")),this._disposeRoot=null!=t.disposeroot&&t.disposeroot===!0,this._loader.babylonScene.autoClear=!!t.autoclear,this._loader.babylonScene.ambientColor=BABYLON.Color3.Black(),null!=t.clearcolor&&(this._loader.babylonScene.clearColor=BABYLON.Utilities.ParseColor4(t.clearcolor)),null!=t.skybox){var r=t.skybox,i=null!=r.skyfog&&r.skyfog,o=null!=r.skysize?r.skysize:1e3,s=null!=r.basename&&""!==r.basename?this._rootUrl+r.basename:null,l=null!=r.extensions&&r.extensions.length>0?r.extensions:null,u=null!=r.polynomial?r.polynomial:1;try{if(null!=s&&""!==s){var c=new BABYLON.CubeTexture(s,this._loader.babylonScene,l);c.name=r.basename,c.coordinatesMode=BABYLON.Texture.SKYBOX_MODE;var p=BABYLON.Mesh.CreateBox("Ambient Skybox",o,this._loader.babylonScene);p.infiniteDistance=!0,p.applyFog=i,this._loader.babylonScene.useRightHandedSystem===!0&&(c.rotationY=Math.PI,p.scaling.x*=-1);var d=new BABYLON.StandardMaterial("SkyboxMaterial",this._loader.babylonScene);d.backFaceCulling=!1,d.disableLighting=!0,d.diffuseColor=new BABYLON.Color3(0,0,0),d.specularColor=new BABYLON.Color3(0,0,0),d.ambientColor=new BABYLON.Color3(0,0,0),d.reflectionTexture=c,p.material=d}}catch(g){console.warn(g)}if(null!=r.environment){var m=r.environment;if(null!=m){var h=null!=m.type&&""!==m.type?m.type:null,f=null!=m.url&&""!==m.url?this._rootUrl+m.url:null,S=null!=m.url&&""!==m.url?m.url:"SkyboxEnvironment";if(null!=h&&""!==h)try{if("image/dds"===h){var y=BABYLON.CubeTexture.CreateFromPrefilteredData(f,this._loader.babylonScene);y.name=S,y.gammaSpace=!1,this._loader.babylonScene.environmentTexture=y}else if("image/env"===h){var M=new BABYLON.CubeTexture(f,this._loader.babylonScene);M.name=S,M.gammaSpace=!1,this._loader.babylonScene.environmentTexture=M}else BABYLON.Tools.Warn("Unsupported environment texture type: "+h);if(null!=this._loader.babylonScene.environmentTexture&&null!=this._loader.babylonScene.environmentTexture.sphericalPolynomial){var v=this._loader.babylonScene;v.isReady()?v.environmentTexture.sphericalPolynomial.scaleInPlace(u):v.onReadyObservable.addOnce(function(){v.environmentTexture.sphericalPolynomial.scaleInPlace(u)})}}catch(_){console.warn(_)}}}}if(null!=t.ambientlighting){var b=t.ambientlighting;if(b===!0&&null!=t.ambientskycolor){var x=.33,P="Ambient Light";this._loader.babylonScene.ambientColor=BABYLON.Utilities.ParseColor3(t.ambientskycolor);var T=this._loader.babylonScene.getLightByName(P);null==T&&(T=new BABYLON.HemisphericLight(P,new BABYLON.Vector3(0,1,0),this._loader.babylonScene)),T.falloffType=BABYLON.Light.FALLOFF_STANDARD,T.lightmapMode=BABYLON.Light.LIGHTMAP_DEFAULT,T.intensityMode=BABYLON.Light.INTENSITYMODE_AUTOMATIC,T.diffuse=BABYLON.Utilities.ParseColor3(t.ambientskycolor),null!=t.ambientlightintensity&&(T.intensity=t.ambientlightintensity*x),null!=t.ambientspecularcolor&&(T.specular=BABYLON.Utilities.ParseColor3(t.ambientspecularcolor)),null!=t.ambientgroundcolor&&(T.groundColor=BABYLON.Utilities.ParseColor3(t.ambientgroundcolor))}}if(null!=t.fogmode){var B=t.fogmode;B>0&&(this._loader.babylonScene.fogMode=B,this._loader.babylonScene.fogEnabled=!0,null!=t.fogdensity&&(this._loader.babylonScene.fogDensity=t.fogdensity),null!=t.fogstart&&(this._loader.babylonScene.fogStart=t.fogstart),null!=t.fogend&&(this._loader.babylonScene.fogEnd=t.fogend),null!=t.fogcolor&&(this._loader.babylonScene.fogColor=BABYLON.Utilities.ParseColor3(t.fogcolor)))}if(null!=t.enablephysics){var O=t.enablephysics;if(O===!0){var C=new BABYLON.Vector3(0,(-9.81),0),k=null==t.deltaworldstep||t.deltaworldstep,A=null!=t.defaultgravity?BABYLON.Utilities.ParseVector3(t.defaultgravity,C):C;if(BABYLON.AmmoJSPlugin){var w=this._loader.babylonScene.isPhysicsEnabled(),L=w===!0?this._loader.babylonScene.getPhysicsEngine():null,I=w===!0&&null!=L&&"AmmoJSPlugin"===L.getPhysicsPluginName();if(I===!1){var U=new BABYLON.AmmoJSPlugin(k);null!=BABYLON.SceneManager.OnSetupPhysicsPlugin&&BABYLON.SceneManager.OnSetupPhysicsPlugin(this._loader.babylonScene,U),this._loader.babylonScene.enablePhysics(A,U),BABYLON.Tools.Log("Enabled ammo.js physics engine plugin")}else BABYLON.Tools.Log("Attached ammo.js physics engine plugin")}else BABYLON.Tools.Warn("Ammo.js physics engine plugin not loaded")}}var N=!1,F=0;if(null!=t.userinput){var D=t.userinput;F=D.joystickInputValue,N=D.disableRightStick;var E=D.joystickRightColorText;null!=E&&""!==E&&(BABYLON.UserInputOptions.JoystickRightHandleColor=E),BABYLON.UserInputOptions.JoystickLeftSensibility=D.joystickLeftLevel,BABYLON.UserInputOptions.JoystickRightSensibility=D.joystickRightLevel,BABYLON.UserInputOptions.JoystickDeadStickValue=D.joystickDeadStick,BABYLON.UserInputOptions.GamepadDeadStickValue=D.padDeadStick,BABYLON.UserInputOptions.GamepadLStickXInverted=D.padLStickXInvert,BABYLON.UserInputOptions.GamepadLStickYInverted=D.padLStickYInvert,BABYLON.UserInputOptions.GamepadRStickXInverted=D.padRStickXInvert,BABYLON.UserInputOptions.GamepadRStickYInverted=D.padRStickYInvert,BABYLON.UserInputOptions.GamepadLStickSensibility=D.padLStickLevel,BABYLON.UserInputOptions.GamepadRStickSensibility=D.padRStickLevel,BABYLON.UserInputOptions.PointerAngularSensibility=D.mouseAngularLevel,BABYLON.UserInputOptions.PointerWheelDeadZone=D.wheelDeadZone}if(null!=t.enableinput){var R=t.enableinput;if(R===!0){var V=null!=t.preventdefault&&t.preventdefault,H=null!=t.usecapture&&t.usecapture,G={preventDefault:V,useCapture:H,enableVirtualJoystick:1===F||2===F&&BABYLON.SceneManager.IsMobile(),disableRightStick:N};BABYLON.SceneManager.EnableUserInput(this._loader.babylonScene,G)}}}},e.prototype._parseMultiMaterialAsync=function(e,n,t,a,r){void 0===r&&(r=function(){});var i=this._loader,o=n;o._data=o._data||{};var s=o._data[a];if(!s){i.logOpen(e+" "+(t.name||""));var l=[],u=new Array;n.forEach(function(n){var t=i.createMaterial(e,n,a);BABYLON.GLTF2.GLTFLoader.AddPointerMetadata(t,e),i._parent.onMaterialLoadedObservable.notifyObservers(t),u.push(i.loadMaterialPropertiesAsync(e,n,t)),l.push(t)}),s={babylonMaterials:l,babylonMeshes:[],promises:u},o._data[a]=s,i.logClose()}return s.babylonMeshes.push(t),t.onDisposeObservable.addOnce(function(){var e=s.babylonMeshes.indexOf(t);e!==-1&&s.babylonMeshes.splice(e,1)}),r(s.babylonMaterials),Promise.all(s.promises).then(function(){return s.babylonMaterials})},e.prototype._parseShaderMaterialPropertiesAsync=function(e,n,t){var a=null!=n.extras&&null!=n.extras.metadata?n.extras.metadata:null,r=t,i=new Array;n.doubleSided&&(r.backFaceCulling=!1);var o=1;if(n.pbrMetallicRoughness){var s=n.pbrMetallicRoughness;if(s){if(s.baseColorFactor){var l=BABYLON.Color4.FromArray(s.baseColorFactor);r.setVector4("diffuseColor",new BABYLON.Vector4(Math.pow(l.r,1/2.2),Math.pow(l.g,1/2.2),Math.pow(l.b,1/2.2),l.a)),o=l.a}else r.setVector4("diffuseColor",new BABYLON.Vector4(1,1,1,1));s.baseColorTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/baseColorTexture",s.baseColorTexture,function(e){e.name=t.name+" (Base Color)";var n=e;n.level=null!=a&&null!=a.diffuseIntensity?a.diffuseIntensity:1,r.setTexture("diffuseTexture",n)}))}}if(n.normalTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/normalTexture",n.normalTexture,function(e){e.name=t.name+" (Normal)";var a=e;void 0!=n.normalTexture.scale&&(a.level=n.normalTexture.scale),r.setTexture("bumpTexture",a)})),n.occlusionTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/occlusionTexture",n.occlusionTexture,function(e){e.name=t.name+" (Occlusion)";var a=e;void 0!=n.occlusionTexture.strength&&(a.level=n.occlusionTexture.strength),r.setTexture("ambientTexture",a)})),n.emissiveFactor){var u=BABYLON.Color4.FromArray(n.emissiveFactor);r.setVector4("emissiveColor",new BABYLON.Vector4(Math.pow(u.r,1/2.2),Math.pow(u.g,1/2.2),Math.pow(u.b,1/2.2),u.a))}n.emissiveTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/emissiveTexture",n.emissiveTexture,function(e){e.name=t.name+" (Emissive)";var n=e;r.setTexture("emissiveTexture",n)})),r.alpha=o;var c=n.alphaMode||"OPAQUE";switch(c){case"OPAQUE":r.alpha=1;break;case"MASK":break;case"BLEND":break;default:throw new Error(e+"/AlphaMode: Invalid value ("+n.alphaMode+")")}if(null!=a){if(a.lightmapTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/lightmapTexture",a.lightmapTexture,function(e){e.name=t.name+" (Light Map)",e.level=a.lightmapLevel?a.lightmapLevel:1,r.setTexture("lightmapTexture",e)})),a.customTextures){var p=function(n){var o=a.customTextures[n];null!=o&&i.push(d._loader.loadTextureInfoAsync(e+"/"+n,o,function(e){e.name=t.name+" (Custom)",r.setTexture(n,e)}))},d=this;for(var g in a.customTextures)p(g)}if(a.customVectors)for(var m in a.customVectors){var h=a.customVectors[m];null!=h&&r.setVector4(m,BABYLON.Vector4.FromArray(h))}if(a.customColors)for(var f in a.customColors){var S=a.customColors[f];null!=S&&r.setVector4(f,BABYLON.Vector4.FromArray(S))}if(a.customFloats)for(var y in a.customFloats){var M=a.customFloats[y];null!=M&&r.setFloat(y,M)}}return Promise.all(i).then(function(){})},e.prototype._parseAlbedoMaterialPropertiesAsync=function(e,n,t){var a=new Array;return a.push(this._loader.loadMaterialPropertiesAsync(e,n,t)),this._parseCommonConstantProperties(a,e,n,t),Promise.all(a).then(function(){})},e.prototype._parseDiffuseMaterialPropertiesAsync=function(e,n,t){var a=null!=n.extras&&null!=n.extras.metadata?n.extras.metadata:null,r=t,i=new Array;BABYLON.Utilities.HasOwnProperty(r,"ambientColor")&&(r.ambientColor=null!=a&&a.ambientColorFactor?BABYLON.Color3.FromArray(a.ambientColorFactor):BABYLON.Color3.Black()),BABYLON.Utilities.HasOwnProperty(r,"specularColor")&&(r.specularColor=BABYLON.Color3.Black()),n.doubleSided&&(BABYLON.Utilities.HasOwnProperty(r,"backFaceCulling")&&(r.backFaceCulling=!1),BABYLON.Utilities.HasOwnProperty(r,"twoSidedLighting")&&(r.twoSidedLighting=!0));var o=1;if(n.pbrMetallicRoughness){var s=n.pbrMetallicRoughness;if(s){if(BABYLON.Utilities.HasOwnProperty(r,"diffuseColor"))if(s.baseColorFactor){var l=BABYLON.Color4.FromArray(s.baseColorFactor);r.diffuseColor=new BABYLON.Color3(Math.pow(l.r,1/2.2),Math.pow(l.g,1/2.2),Math.pow(l.b,1/2.2)),o=l.a}else r.diffuseColor=BABYLON.Color3.White();BABYLON.Utilities.HasOwnProperty(r,"diffuseTexture")&&s.baseColorTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/baseColorTexture",s.baseColorTexture,function(e){e.name=t.name+" (Base Color)",r.diffuseTexture=e,r.diffuseTexture.level=null!=a&&null!=a.diffuseIntensity?a.diffuseIntensity:1}))}}if(BABYLON.Utilities.HasOwnProperty(r,"bumpTexture")&&n.normalTexture&&(i.push(this._loader.loadTextureInfoAsync(e+"/normalTexture",n.normalTexture,function(e){e.name=t.name+" (Normal)",r.bumpTexture=e,void 0!=n.normalTexture.scale&&(r.bumpTexture.level=n.normalTexture.scale)})),BABYLON.Utilities.HasOwnProperty(r,"invertNormalMapX")&&(r.invertNormalMapX=!this._loader.babylonScene.useRightHandedSystem),BABYLON.Utilities.HasOwnProperty(r,"invertNormalMapY")&&(r.invertNormalMapY=this._loader.babylonScene.useRightHandedSystem)),BABYLON.Utilities.HasOwnProperty(r,"ambientTexture")&&n.occlusionTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/occlusionTexture",n.occlusionTexture,function(e){e.name=t.name+" (Occlusion)",r.ambientTexture=e,void 0!=n.occlusionTexture.strength&&(r.ambientTexture.level=n.occlusionTexture.strength)})),BABYLON.Utilities.HasOwnProperty(r,"emissiveColor")){var u=n.emissiveFactor?BABYLON.Color4.FromArray(n.emissiveFactor):new BABYLON.Color4(0,0,0,1);r.emissiveColor=new BABYLON.Color3(Math.pow(u.r,1/2.2),Math.pow(u.g,1/2.2),Math.pow(u.b,1/2.2))}BABYLON.Utilities.HasOwnProperty(r,"emissiveTexture")&&n.emissiveTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/emissiveTexture",n.emissiveTexture,function(e){e.name=t.name+" (Emissive)",r.emissiveTexture=e,BABYLON.Utilities.HasOwnProperty(r,"useEmissiveAsIllumination")&&(r.useEmissiveAsIllumination=null!=a&&null!=a.useEmissiveAsIllumination&&a.useEmissiveAsIllumination)})),BABYLON.Utilities.HasOwnProperty(r,"alpha")&&(r.alpha=o);var c=n.alphaMode||"OPAQUE";switch(c){case"OPAQUE":BABYLON.Utilities.HasOwnProperty(r,"alpha")&&(r.alpha=1);break;case"MASK":r.alphaCutOff=void 0==n.alphaCutoff?.5:n.alphaCutoff,r.diffuseTexture&&BABYLON.Utilities.HasOwnProperty(r,"diffuseTexture")&&(r.diffuseTexture.hasAlpha=!0);break;case"BLEND":r.diffuseTexture&&(BABYLON.Utilities.HasOwnProperty(r,"diffuseTexture")&&(r.diffuseTexture.hasAlpha=!0),BABYLON.Utilities.HasOwnProperty(r,"useAlphaFromDiffuseTexture")&&(r.useAlphaFromDiffuseTexture=!0));break;default:throw new Error(e+"/AlphaMode: Invalid value ("+n.alphaMode+")")}return this._parseCommonConstantProperties(i,e,n,t),Promise.all(i).then(function(){})},e.prototype._parseCommonConstantProperties=function(e,n,t,a){var r=null!=t.extras&&null!=t.extras.metadata?t.extras.metadata:null;if(null!=r){var i=a;if(BABYLON.Utilities.HasOwnProperty(i,"directIntensity")&&(i.directIntensity=null!=r.directIntensity?r.directIntensity:1),BABYLON.Utilities.HasOwnProperty(i,"specularIntensity")&&(i.specularIntensity=null!=r.specularIntensity?r.specularIntensity:1),BABYLON.Utilities.HasOwnProperty(i,"emissiveIntensity")&&(i.emissiveIntensity=null!=r.emissiveIntensity?r.emissiveIntensity:1),BABYLON.Utilities.HasOwnProperty(i,"environmentIntensity")&&(i.environmentIntensity=null!=r.environmentIntensity?r.environmentIntensity:1),BABYLON.Utilities.HasOwnProperty(i,"unlit")&&(i.unlit=null!=r.unlitMaterial&&r.unlitMaterial),BABYLON.Utilities.HasOwnProperty(i,"disableLighting")&&(i.disableLighting=null!=r.disableLighting&&r.disableLighting),BABYLON.Utilities.HasOwnProperty(i,"maxSimultaneousLights")&&(i.maxSimultaneousLights=null!=r.maxSimultaneousLights?r.maxSimultaneousLights:4),BABYLON.Utilities.HasOwnProperty(i,"lightmapTexture")&&r.lightmapTexture){var o=!0;BABYLON.Utilities.HasOwnProperty(i,"useLightmapAsShadowmap")&&(o=null==r.useLightmapAsShadowmap||r.useLightmapAsShadowmap),e.push(this._loader.loadTextureInfoAsync(n+"/lightmapTexture",r.lightmapTexture,function(e){e.name=a.name+" (Light Map)",e.level=r.lightmapLevel?r.lightmapLevel:1,i.lightmapTexture=e,i.useLightmapAsShadowmap=o}))}if(a instanceof BABYLON.UniversalPushMaterial||a instanceof BABYLON.UniversalAlbedoMaterial||a instanceof BABYLON.UniversalDiffuseMaterial){var s=a;if(r.customTextures){var l=function(t){var i=r.customTextures[t];null!=i&&(s.checkSampler(t),e.push(u._loader.loadTextureInfoAsync(n+"/"+t,i,function(e){e.name=a.name+" (Custom)",s.setTexture(t,e,!0)})))},u=this;for(var c in r.customTextures)l(c)}if(r.customVectors)for(var p in r.customVectors){var d=r.customVectors[p];null!=d&&s.setVector4(p,BABYLON.Vector4.FromArray(d),!0)}if(r.customColors)for(var g in r.customColors){var m=r.customColors[g];null!=m&&s.setVector4(g,BABYLON.Vector4.FromArray(m),!0)}if(r.customFloats)for(var h in r.customFloats){var f=r.customFloats[h];null!=f&&s.setFloat(h,f,!0)}}else{if(r.customTextures){var S=function(t){var o=r.customTextures[t];null!=o&&BABYLON.Utilities.HasOwnProperty(i,t)&&e.push(y._loader.loadTextureInfoAsync(n+"/"+t,o,function(e){e.name=a.name+" (Custom)",i[t]=e}))},y=this;for(var c in r.customTextures)S(c)}if(r.customVectors)for(var p in r.customVectors){var d=r.customVectors[p];null!=d&&BABYLON.Utilities.HasOwnProperty(i,p)&&(i[p]=BABYLON.Vector4.FromArray(d))}if(r.customColors)for(var g in r.customColors){var m=r.customColors[g];null!=m&&BABYLON.Utilities.HasOwnProperty(i,g)&&(i[g]instanceof BABYLON.Vector4?i[g]=BABYLON.Vector4.FromArray(m):i[g]instanceof BABYLON.Color4?i[g]=BABYLON.Color4.FromArray(m):i[g]=BABYLON.Color3.FromArray(m))}if(r.customFloats)for(var h in r.customFloats){var f=r.customFloats[h];null!=f&&BABYLON.Utilities.HasOwnProperty(i,h)&&(i[h]instanceof Boolean?i[h]=f>0:i[h]=f)}}}},e}(),CVTOOLS_babylon_mesh=function(){function e(e){this.name=CVTOOLS_MESH,this.enabled=!0,this._loader=e}return e.prototype.dispose=function(){delete this._loader},e}(),CVTOOLS_left_handed=function(){function e(e){this.name=CVTOOLS_HAND,this.enabled=!0,this._loader=e}return e.prototype.dispose=function(){delete this._loader},e}();BABYLON.GLTF2.GLTFLoader.RegisterExtension(CVTOOLS_NAME,function(e){return new CVTOOLS_unity_metadata(e)}),BABYLON.GLTF2.GLTFLoader.RegisterExtension(CVTOOLS_MESH,function(e){return new CVTOOLS_babylon_mesh(e)}),BABYLON.GLTF2.GLTFLoader.RegisterExtension(CVTOOLS_HAND,function(e){return new CVTOOLS_left_handed(e)}),BABYLON.SceneLoader.OnPluginActivatedObservable.add(function(e){"gltf"===e.name&&(null!=BABYLON.SceneManager.AnimationStartMode&&(e.animationStartMode=BABYLON.SceneManager.AnimationStartMode),null!=BABYLON.SceneManager.ForceRightHanded&&BABYLON.SceneManager.ForceRightHanded===!0&&(e.coordinateSystemMode=BABYLON.GLTFLoaderCoordinateSystemMode.FORCE_RIGHT_HANDED),e.dispose())});